parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"crkq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Animation=d,exports.setImagePath=k,exports.setAudioPath=C,exports.setDataPath=O,exports.loadImage=M,exports.loadAudio=L,exports.loadData=I,exports.load=Y,exports.Button=Ot,exports.init=a,exports.getCanvas=r,exports.getContext=o,exports.on=s,exports.off=n,exports.emit=h,exports.GameLoop=Lt,exports.GameObject=et,exports.Grid=Dt,exports.degToRad=T,exports.radToDeg=D,exports.angleToTarget=X,exports.rotatePoint=R,exports.randInt=z,exports.seedRand=N,exports.lerp=W,exports.inverseLerp=G,exports.clamp=F,exports.setStoreItem=U,exports.getStoreItem=H,exports.collides=B,exports.getWorldRect=K,exports.initKeys=Ft,exports.bindKeys=Ut,exports.unbindKeys=Ht,exports.keyPressed=Bt,exports.registerPlugin=qt,exports.unregisterPlugin=Vt,exports.extendObject=Jt,exports.initPointer=vt,exports.getPointer=ut,exports.track=At,exports.untrack=St,exports.pointerOver=jt,exports.onPointerDown=Et,exports.onPointerUp=Pt,exports.pointerPressed=kt,exports.Pool=Zt,exports.Quadtree=ie,exports.Scene=he,exports.Sprite=st,exports.SpriteSheet=ae,exports.Text=ot,exports.TileEngine=ce,exports.Vector=q,exports.keyMap=exports.dataAssets=exports.audioAssets=exports.imageAssets=exports.default=void 0;let t,e,i={};function s(t,e){i[t]=i[t]||[],i[t].push(e)}function n(t,e){i[t]=(i[t]||[]).filter(t=>t!=e)}function h(t,...e){(i[t]||[]).map(t=>t(...e))}function r(){return t}function o(){return e}function a(i){if(!(t=document.getElementById(i)||i||document.querySelector("canvas")))throw Error("You must provide a canvas element for the game");return(e=t.getContext("2d")).imageSmoothingEnabled=!1,h("init"),{canvas:t,context:e}}class c{constructor({spriteSheet:t,frames:e,frameRate:i,loop:s=!0}){this.spriteSheet=t,this.frames=e,this.frameRate=i,this.loop=s;let{width:n,height:h,margin:r=0}=t.frame;this.width=n,this.height=h,this.margin=r,this._f=0,this._a=0}clone(){return new c(this)}reset(){this._f=0,this._a=0}update(t=1/60){if(this.loop||this._f!=this.frames.length-1)for(this._a+=t;this._a*this.frameRate>=1;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render({x:t,y:e,width:i=this.width,height:s=this.height,context:n=o()}){let h=this.frames[this._f]/this.spriteSheet._f|0,r=this.frames[this._f]%this.spriteSheet._f|0;n.drawImage(this.spriteSheet.image,r*this.width+(2*r+1)*this.margin,h*this.height+(2*h+1)*this.margin,this.width,this.height,t,e,i,s)}}function d(){return new c(...arguments)}d.prototype=c.prototype,d.class=c;let l=/(jpeg|jpg|gif|png)$/,u=/(wav|mp3|ogg|aac)$/,p=/^\//,_=/\/$/,f=new WeakMap,x="",g="",w="";function m(t,e){return new URL(t,e).href}function y(t,e){return[t.replace(_,""),t?e.replace(p,""):e].filter(t=>t).join("/")}function b(t){return t.split(".").pop()}function v(t){let e=t.replace("."+b(t),"");return 2==e.split("/").length?e.replace(p,""):e}function A(t){return{wav:t.canPlayType('audio/wav; codecs="1"'),mp3:t.canPlayType("audio/mpeg;"),ogg:t.canPlayType('audio/ogg; codecs="vorbis"'),aac:t.canPlayType("audio/aac;")}}let S={};exports.imageAssets=S;let j={};exports.audioAssets=j;let E={};function P(){window.__k||(window.__k={dm:f,u:m,d:E,i:S})}function k(t){x=t}function C(t){g=t}function O(t){w=t}function M(t){return P(),new Promise((e,i)=>{let s,n,r;if(s=y(x,t),S[s])return e(S[s]);(n=new Image).onload=function(){r=m(s,window.location.href),S[v(t)]=S[s]=S[r]=this,h("assetLoaded",this,t),e(this)},n.onerror=function(){i("Unable to load image "+s)},n.src=s})}function L(t){return new Promise((e,i)=>{let s,n,r,o,a=t;return s=new Audio,n=A(s),(t=[].concat(t).reduce((t,e)=>t||(n[b(e)]?e:null),0))?(r=y(g,t),j[r]?e(j[r]):(s.addEventListener("canplay",function(){o=m(r,window.location.href),j[v(t)]=j[r]=j[o]=this,h("assetLoaded",this,t),e(this)}),s.onerror=function(){i("Unable to load audio "+r)},s.src=r,void s.load())):i("cannot play any of the audio formats provided "+a)})}function I(t){let e,i;return P(),e=y(w,t),E[e]?Promise.resolve(E[e]):fetch(e).then(t=>{if(!t.ok)throw t;return t.clone().json().catch(()=>t.text())}).then(s=>(i=m(e,window.location.href),"object"==typeof s&&f.set(s,i),E[v(t)]=E[e]=E[i]=s,h("assetLoaded",s,t),s))}function Y(...t){return P(),Promise.all(t.map(t=>{let e=b([].concat(t)[0]);return e.match(l)?M(t):e.match(u)?L(t):I(t)}))}function T(t){return t*Math.PI/180}function D(t){return 180*t/Math.PI}function X(t,e){return Math.atan2(e.y-t.y,e.x-t.x)+Math.PI/2}function R(t,e){let i=Math.sin(e),s=Math.cos(e);return{x:t.x*s-t.y*i,y:t.x*i+t.y*s}}function z(t,e){return Math.floor(Math.random()*(e-t+1))+t}function N(t){for(var e=0,i=2166136261;e<t.length;e++)i=Math.imul(i^t.charCodeAt(e),16777619);i+=i<<13,i^=i>>>7,i+=i<<3,i^=i>>>17;let s=(i+=i<<5)>>>0,n=()=>(2**31-1&(s=Math.imul(48271,s)))/2**31;return n(),n}function W(t,e,i){return t*(1-i)+e*i}function G(t,e,i){return(i-t)/(e-t)}function F(t,e,i){return Math.min(Math.max(t,i),e)}function U(t,e){void 0===e?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(e))}function H(t){let e=localStorage.getItem(t);try{e=JSON.parse(e)}catch(i){}return e}function B(t,e){return t.rotation||e.rotation?null:([t,e]=[t,e].map(t=>K(t)),t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y)}function K(t){let{x:e,y:i,width:s,height:n}=t.world||t;return t.anchor&&(e-=s*t.anchor.x,i-=n*t.anchor.y),s<0&&(e+=s,s*=-1),n<0&&(i+=n,n*=-1),{x:e,y:i,width:s,height:n}}exports.dataAssets=E;class ${constructor(t=0,e=0,i={}){this.x=t,this.y=e,i._c&&(this.clamp(i._a,i._b,i._d,i._e),this.x=t,this.y=e)}add(t){return new $(this.x+t.x,this.y+t.y,this)}subtract(t){return new $(this.x-t.x,this.y-t.y,this)}scale(t){return new $(this.x*t,this.y*t)}normalize(t=this.length()){return new $(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}clamp(t,e,i,s){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=s}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?F(this._a,this._d,t):t}set y(t){this._y=this._c?F(this._b,this._e,t):t}}function q(){return new $(...arguments)}q.prototype=$.prototype,q.class=$;class V{constructor(t){return this.init(t)}init(t={}){this.position=q(),this.velocity=q(),this.acceleration=q(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let e=this.acceleration;t&&(e=e.scale(t)),this.velocity=this.velocity.add(e);let i=this.velocity;t&&(i=i.scale(t)),this.position=this.position.add(i),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}_pc(){}}const J=()=>{},Q="position:absolute;left:-9999px";function Z(t,e){let i=e.parentNode;if(t.setAttribute("data-kontra",""),i){let s=i.querySelector("[data-kontra]:last-of-type")||e;i.insertBefore(t,s.nextSibling)}else document.body.appendChild(t)}class tt extends V{init({width:t=0,height:e=0,context:i=o(),render:s=this.draw,update:n=this.advance,children:h=[],anchor:r={x:0,y:0},sx:a=0,sy:c=0,opacity:d=1,rotation:l=0,scaleX:u=1,scaleY:p=1,..._}={}){this.children=[],super.init({width:t,height:e,context:i,anchor:r,sx:a,sy:c,opacity:d,rotation:l,scaleX:u,scaleY:p,..._}),this._di=!0,this._uw(),h.map(t=>this.addChild(t)),this._rf=s,this._uf=n}update(t){this._uf(t),this.children.map(t=>t.update&&t.update())}render(t){let e=this.context;e.save(),(this.x||this.y)&&e.translate(this.x,this.y),this.rotation&&e.rotate(this.rotation),(this.sx||this.sy)&&e.translate(-this.sx,-this.sy),1==this.scaleX&&1==this.scaleY||e.scale(this.scaleX,this.scaleY);let i=-this.width*this.anchor.x,s=-this.height*this.anchor.y;(i||s)&&e.translate(i,s),this.context.globalAlpha=this.opacity,this._rf(),(i||s)&&e.translate(-i,-s);let n=this.children;t&&(n=n.filter(t)),n.map(t=>t.render&&t.render()),e.restore()}draw(){}_pc(t,e){this._uw(),this.children.map(t=>t._pc())}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:e=0,_wo:i=1,_wr:s=0,_wsx:n=1,_wsy:h=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=i*this.opacity,this._wr=s+this.rotation;let{x:r,y:o}=R({x:this.x,y:this.y},s);this._wx=r,this._wy=o,this._wsx=n*this.scaleX,this._wsy=h*this.scaleY,this._wx=this.x*n,this._wy=this.y*h,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this._wx+=t,this._wy+=e}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo,rotation:this._wr,scaleX:this._wsx,scaleY:this._wsy}}addChild(t,{absolute:e=!1}={}){this.children.push(t),t.parent=this,t._pc=t._pc||J,t._pc()}removeChild(t){let e=this.children.indexOf(t);-1!==e&&(this.children.splice(e,1),t.parent=null,t._pc())}get opacity(){return this._opa}set opacity(t){this._opa=t,this._pc()}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc()}setScale(t,e=t){this.scaleX=t,this.scaleY=e}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc()}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc()}}function et(){return new tt(...arguments)}et.prototype=tt.prototype,et.class=tt;class it extends et.class{init({image:t,width:e=(t?t.width:void 0),height:i=(t?t.height:void 0),...s}={}){super.init({image:t,width:e,height:i,...s})}get animations(){return this._a}set animations(t){let e,i;for(e in this._a={},t)this._a[e]=t[e].clone(),i=i||this._a[e];this.currentAnimation=i,this.width=this.width||i.width,this.height=this.height||i.height}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){super.advance(t),this.currentAnimation&&this.currentAnimation.update(t)}draw(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}function st(){return new it(...arguments)}st.prototype=it.prototype,st.class=it;let nt=/(\d+)(\w+)/;function ht(t){let e=t.match(nt),i=+e[1];return{size:i,unit:e[2],computed:i}}class rt extends et.class{init({text:t="",textAlign:e="",lineHeight:i=1,font:s=o().font,...n}={}){super.init({text:t,textAlign:e,lineHeight:i,font:s,...n}),this._p()}get width(){return this._w}set width(t){this._d=!0,this._w=t,this._fw=t}get text(){return this._t}set text(t){this._d=!0,this._t=t}get font(){return this._f}set font(t){this._d=!0,this._f=t,this._fs=ht(t).computed}get lineHeight(){return this._lh}set lineHeight(t){this._d=!0,this._lh=t}render(){this._d&&this._p(),super.render()}_p(){this._s=[],this._d=!1;let t=this.context;if(t.font=this.font,!this._s.length&&this._fw){let e=this.text.split(" "),i=0,s=2;for(;s<=e.length;s++){let n=e.slice(i,s).join(" ");t.measureText(n).width>this._fw&&(this._s.push(e.slice(i,s-1).join(" ")),i=s-1)}this._s.push(e.slice(i,s).join(" "))}if(!this._s.length&&this.text.includes("\n")){let e=0;this.text.split("\n").map(i=>{this._s.push(i),e=Math.max(e,t.measureText(i).width)}),this._w=this._fw||e}this._s.length||(this._s.push(this.text),this._w=this._fw||t.measureText(this.text).width),this.height=this._fs+(this._s.length-1)*this._fs*this.lineHeight,this._uw()}draw(){let t=0,e=this.textAlign,i=this.context;e=this.textAlign||("rtl"===i.canvas.dir?"right":"left"),t="right"===e?this.width:"center"===e?this.width/2|0:0,this._s.map((s,n)=>{i.textBaseline="top",i.textAlign=e,i.fillStyle=this.color,i.font=this.font,i.fillText(s,t,this._fs*this.lineHeight*n)})}}function ot(){return new rt(...arguments)}ot.prototype=rt.prototype,ot.class=rt;let at=new WeakMap,ct={},dt={},lt={0:"left",1:"middle",2:"right"};function ut(t=r()){return at.get(t)}function pt(t,e){let{x:i,y:s,width:n,height:h}=K(t);do{i-=t.sx||0,s-=t.sy||0}while(t=t.parent);let r=e.x-Math.max(i,Math.min(e.x,i+n)),o=e.y-Math.max(s,Math.min(e.y,s+h));return r*r+o*o<e.radius*e.radius}function _t(t){let e=t._lf.length?t._lf:t._cf;for(let i=e.length-1;i>=0;i--){let s=e[i];if(s.collidesWithPointer?s.collidesWithPointer(t):pt(s,t))return s}}function ft(t,e){return parseFloat(t.getPropertyValue(e))||0}function xt(t){let{canvas:e,_s:i}=t,s=e.getBoundingClientRect(),n="none"!==i.transform?i.transform.replace("matrix(","").split(","):[1,1,1,1],h=parseFloat(n[0]),r=parseFloat(n[3]),o=(ft(i,"border-left-width")+ft(i,"border-right-width"))*h,a=(ft(i,"border-top-width")+ft(i,"border-bottom-width"))*r,c=(ft(i,"padding-left")+ft(i,"padding-right"))*h,d=(ft(i,"padding-top")+ft(i,"padding-bottom"))*r;return{scaleX:(s.width-o-c)/e.width,scaleY:(s.height-a-d)/e.height,offsetX:s.left+(ft(i,"border-left-width")+ft(i,"padding-left"))*h,offsetY:s.top+(ft(i,"border-top-width")+ft(i,"padding-top"))*r}}function gt(t){let e=void 0!==t.button?lt[t.button]:"left";dt[e]=!0,bt(t,"onDown")}function wt(t){let e=void 0!==t.button?lt[t.button]:"left";dt[e]=!1,bt(t,"onUp")}function mt(t){bt(t,"onOver")}function yt(t){at.get(t.target)._oo=null,dt={}}function bt(t,e){t.preventDefault();let i=t.target,s=at.get(i),{scaleX:n,scaleY:h,offsetX:r,offsetY:o}=xt(s);if(-1!==["touchstart","touchmove","touchend"].indexOf(t.type)){s.touches={};for(var a=0;a<t.touches.length;a++)s.touches[t.touches[a].identifier]={id:t.touches[a].identifier,x:(t.touches[a].clientX-r)/n,y:(t.touches[a].clientY-o)/h,changed:!1};for(a=t.changedTouches.length;a--;){const i=t.changedTouches[a].identifier;void 0!==s.touches[i]&&(s.touches[i].changed=!0);let c=t.changedTouches[a].clientX,d=t.changedTouches[a].clientY;s.x=(c-r)/n,s.y=(d-o)/h;let l=_t(s);l&&l[e]&&l[e](t),ct[e]&&ct[e](t,l)}}else{s.x=(t.clientX-r)/n,s.y=(t.clientY-o)/h;let i=_t(s);i&&i[e]&&i[e](t),ct[e]&&ct[e](t,i),"onOver"==e&&(i!=s._oo&&s._oo&&s._oo.onOut&&s._oo.onOut(t),s._oo=i)}}function vt(t=r()){let e=at.get(t);if(!e){let i=window.getComputedStyle(t);e={x:0,y:0,radius:5,touches:{},canvas:t,_cf:[],_lf:[],_o:[],_oo:null,_s:i},at.set(t,e)}return t.addEventListener("mousedown",gt),t.addEventListener("touchstart",gt),t.addEventListener("mouseup",wt),t.addEventListener("touchend",wt),t.addEventListener("touchcancel",wt),t.addEventListener("blur",yt),t.addEventListener("mousemove",mt),t.addEventListener("touchmove",mt),e._t||(e._t=!0,s("tick",()=>{e._lf.length=0,e._cf.map(t=>{e._lf.push(t)}),e._cf.length=0})),e}function At(...t){t.map(t=>{let e=t.context?t.context.canvas:r(),i=at.get(e);if(!i)throw new ReferenceError("Pointer events not initialized for the objects canvas");t._r||(t._r=t.render,t.render=function(){i._cf.push(this),this._r()},i._o.push(t))})}function St(...t){t.map(t=>{let e=t.context?t.context.canvas:r(),i=at.get(e);if(!i)throw new ReferenceError("Pointer events not initialized for the objects canvas");t.render=t._r,t._r=0;let s=i._o.indexOf(t);-1!==s&&i._o.splice(s,1)})}function jt(t){let e=t.context?t.context.canvas:r(),i=at.get(e);if(!i)throw new ReferenceError("Pointer events not initialized for the objects canvas");return i._o.includes(t)&&_t(i)===t}function Et(t){ct.onDown=t}function Pt(t){ct.onUp=t}function kt(t){return!!dt[t]}class Ct extends st.class{init({padX:t=0,padY:e=0,text:i,onDown:s,onUp:n,...h}={}){super.init({padX:t,padY:e,...h}),this.textNode=ot({...i,context:this.context}),this.width||(this.width=this.textNode.width,this.height=this.textNode.height),At(this),this.addChild(this.textNode),this._od=s||J,this._ou=n||J;const r=this._dn=document.createElement("button");r.style=Q,r.textContent=this.text,r.addEventListener("focus",()=>this.focus()),r.addEventListener("blur",()=>this.blur()),r.addEventListener("keydown",t=>this._kd(t)),r.addEventListener("keyup",t=>this._ku(t)),Z(r,this.context.canvas),this._uw(),this._p()}get text(){return this.textNode.text}set text(t){this._d=!0,this.textNode.text=t}destroy(){this._dn.remove()}_p(){this.text!==this._dn.textContent&&(this._dn.textContent=this.text),this.textNode._p();let t=this.textNode.width+2*this.padX,e=this.textNode.height+2*this.padY;this.width=Math.max(t,this.width),this.height=Math.max(e,this.height),this._uw()}render(){this._d&&this._p(),super.render()}enable(){this.disabled=this._dn.disabled=!1,this.onEnable()}disable(){this.disabled=this._dn.disabled=!0,this.onDisable()}focus(){this.disabled||(this.focused=!0,document.activeElement!=this._dn&&this._dn.focus(),this.onFocus())}blur(){this.focused=!1,document.activeElement==this._dn&&this._dn.blur(),this.onBlur()}onOver(){this.disabled||(this.hovered=!0)}onOut(){this.hovered=!1}onEnable(){}onDisable(){}onFocus(){}onBlur(){}onDown(){this.disabled||(this.pressed=!0,this._od())}onUp(){this.disabled||(this.pressed=!1,this._ou())}_kd(t){"Enter"!=t.code&&"Space"!=t.code||this.onDown()}_ku(t){"Enter"!=t.code&&"Space"!=t.code||this.onUp()}}function Ot(){return new Ct(...arguments)}function Mt(t){let e=t.canvas;t.clearRect(0,0,e.width,e.height)}function Lt({fps:t=60,clearCanvas:e=!0,update:i=J,render:s,context:n=o()}={}){if(!s)throw Error("You must provide a render() function");let r,a,c,d,l,u=0,p=1e3/t,_=1/t,f=e?Mt:J;function x(){if(a=requestAnimationFrame(x),c=performance.now(),d=c-r,r=c,!(d>1e3)){for(h("tick"),u+=d;u>=p;)l.update(_),u-=p;f(n),l.render()}}return l={update:i,render:s,isStopped:!0,start(){r=performance.now(),this.isStopped=!1,requestAnimationFrame(x)},stop(){this.isStopped=!0,cancelAnimationFrame(a)},_frame:x,set _last(t){r=t}}}Ot.prototype=Ct.prototype,Ot.class=Ct;let It={set:(t,e,i)=>(e.startsWith("_")||(t._d=!0),Reflect.set(t,e,i))},Yt={start:t=>t?1:0,center:()=>.5,end:t=>t?0:1};class Tt extends et.class{init({flow:t="column",align:e="start",justify:i="start",colGap:s=0,rowGap:n=0,numCols:h=1,dir:r="",breakpoints:o=[],...a}={}){return super.init({flow:t,align:e,justify:i,colGap:s,rowGap:n,numCols:h,dir:r,breakpoints:o,...a}),this._p(),new Proxy(this,It)}addChild(t){this._d=!0,super.addChild(t)}removeChild(t){this._d=!0,super.removeChild(t)}render(){this._d&&this._p(),super.render()}destroy(){this.children.map(t=>t.destroy&&t.destroy())}_p(){this._d=!1,this.breakpoints.map(t=>{t.metric.call(this)&&this._b!==t&&(this._b=t,t.callback.call(this))});let t=this._g=[],e=this._cw=[],i=this._rh=[],s=this.children,n=this._nc="column"===this.flow?1:"row"===this.flow?s.length:this.numCols,h=0,r=0;for(let p,_=0;p=s[_];_++){t[h]=t[h]||[],p._p&&p._p(),i[h]=Math.max(i[h]||0,p.height);let s=p.colSpan||1,o=s;do{e[r]=Math.max(e[r]||0,p.width/o),t[h][r]=p}while(o+r++<=n&&--s);r>=n&&(r=0,h++)}for(;r>0&&r<n;)t[h][r++]=!1;let o=t.length,a=[].concat(this.colGap),c=[].concat(this.rowGap);this._w=e.reduce((t,e)=>t+=e,0);for(let p=0;p<n-1;p++)this._w+=a[p%a.length];this._h=i.reduce((t,e)=>t+=e,0);for(let p=0;p<o-1;p++)this._h+=c[p%c.length];this._uw();let d="rtl"===this.context.canvas.dir&&!this.dir||"rtl"===this.dir;this._rtl=d,d&&(this._g=t.map(t=>t.reverse()),this._cw=e.reverse());let l=-this.anchor.y*this.height,u=[];this._g.map((t,s)=>{let n=-this.anchor.x*this.width;t.map((t,h)=>{if(t&&!u.includes(t)){u.push(t);let r=Yt[t.justifySelf||this.justify](this._rtl),o=Yt[t.alignSelf||this.align](),c=t.colSpan||1,d=e[h];if(c>1&&h+c<=this._nc)for(let t=1;t<c;t++)d+=e[h+t]+a[(h+t)%a.length];let p=d*r,_=i[s]*o,f=0,x=0,{width:g,height:w}=t;if(t.anchor&&(f=t.anchor.x,x=t.anchor.y),0===r)p+=g*f;else if(.5===r){p+=(f<.5?-1:.5===f?0:1)*g*r}else p-=g*(1-f);if(0===o)_+=w*x;else if(.5===o){_+=(x<.5?-1:.5===x?0:1)*w*o}else _-=w*(1-x);t.x=n+p,t.y=l+_}n+=e[h]+a[h%a.length]}),l+=i[s]+c[s%c.length]})}}function Dt(){return new Tt(...arguments)}Dt.prototype=Tt.prototype,Dt.class=Tt;let Xt={},Rt={},zt={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"left",ArrowUp:"up",ArrowRight:"right",ArrowDown:"down"};function Nt(t){let e=zt[t.code];Rt[e]=!0,Xt[e]&&Xt[e](t)}function Wt(t){Rt[zt[t.code]]=!1}function Gt(){Rt={}}function Ft(){let t;for(t=0;t<26;t++)zt[t+65]=zt["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)zt[48+t]=zt["Digit"+t]=""+t;window.addEventListener("keydown",Nt),window.addEventListener("keyup",Wt),window.addEventListener("blur",Gt)}function Ut(t,e){[].concat(t).map(t=>Xt[t]=e)}function Ht(t){[].concat(t).map(t=>Xt[t]=0)}function Bt(t){return!!Rt[t]}function Kt(t){let e=t.substr(t.search(/[A-Z]/));return e[0].toLowerCase()+e.substr(1)}function $t(t,e){let i=t.indexOf(e);-1!==i&&t.splice(i,1)}function qt(t,e){let i=t.prototype;i&&(i._inc||(i._inc={},i._bInc=function(t,e,...i){return this._inc[e].before.reduce((e,i)=>{let s=i(t,...e);return s||e},i)},i._aInc=function(t,e,i,...s){return this._inc[e].after.reduce((e,i)=>{let n=i(t,e,...s);return n||e},i)}),Object.getOwnPropertyNames(e).forEach(t=>{let s=Kt(t);i[s]&&(i["_o"+s]||(i["_o"+s]=i[s],i[s]=function(...t){let e=this._bInc(this,s,...t),n=i["_o"+s].call(this,...e);return this._aInc(this,s,n,...t)}),i._inc[s]||(i._inc[s]={before:[],after:[]}),t.startsWith("before")?i._inc[s].before.push(e[t]):t.startsWith("after")&&i._inc[s].after.push(e[t]))}))}function Vt(t,e){let i=t.prototype;i&&i._inc&&Object.getOwnPropertyNames(e).forEach(t=>{let s=Kt(t);t.startsWith("before")?$t(i._inc[s].before,e[t]):t.startsWith("after")&&$t(i._inc[s].after,e[t])})}function Jt(t,e){let i=t.prototype;i&&Object.getOwnPropertyNames(e).forEach(t=>{i[t]||(i[t]=e[t])})}exports.keyMap=zt;class Qt{constructor({create:t,maxSize:e=1024}={}){let i;if(!t||!(i=t())||!(i.update&&i.init&&i.isAlive&&i.render))throw Error("Must provide create() function which returns an object with init(), update(), render(), and isAlive() functions");this._c=t,this.objects=[t()],this.size=0,this.maxSize=e}get(t={}){if(this.size===this.objects.length){if(this.size===this.maxSize)return;for(let t=0;t<this.size&&this.objects.length<this.maxSize;t++)this.objects.push(this._c())}let e=this.objects[this.size];return this.size++,e.init(t),e}getAliveObjects(){return this.objects.slice(0,this.size)}clear(){this.size=this.objects.length=0,this.objects.push(this._c())}update(t){let e,i=!1;for(let s=this.size;s--;)(e=this.objects[s]).update(t),e.isAlive()||(i=!0,this.size--);i&&this.objects.sort((t,e)=>e.isAlive()-t.isAlive())}render(){for(let t=this.size;t--;)this.objects[t].render()}}function Zt(){return new Qt(...arguments)}function te(t,e){let i=[],s=e.x+e.width/2,n=e.y+e.height/2,{x:h,y:r,width:o,height:a}=K(t),c=t.y<n,d=t.y+t.height>=n;return t.x<s&&(c&&i.push(0),d&&i.push(2)),t.x+t.width>=s&&(c&&i.push(1),d&&i.push(3)),i}Zt.prototype=Qt.prototype,Zt.class=Qt;class ee{constructor({maxDepth:t=3,maxObjects:e=25,bounds:i}={}){this.maxDepth=t,this.maxObjects=e;let s=r();this.bounds=i||{x:0,y:0,width:s.width,height:s.height},this._b=!1,this._d=0,this._o=[],this._s=[],this._p=null}clear(){this._s.map(function(t){t.clear()}),this._b=!1,this._o.length=0}get(t){let e=new Set;for(;this._s.length&&this._b;)return te(t,this.bounds).map(i=>{this._s[i].get(t).map(t=>e.add(t))}),Array.from(e);return this._o.filter(e=>e!==t)}add(...t){t.map(t=>{Array.isArray(t)?this.add.apply(this,t):this._b?this._a(t):(this._o.push(t),this._o.length>this.maxObjects&&this._d<this.maxDepth&&(this._sp(),this._o.map(t=>this._a(t)),this._o.length=0))})}_a(t){te(t,this.bounds).map(e=>{this._s[e].add(t)})}_sp(t,e,i){if(this._b=!0,!this._s.length)for(t=this.bounds.width/2|0,e=this.bounds.height/2|0,i=0;i<4;i++)this._s[i]=new ee({bounds:{x:this.bounds.x+(i%2==1?t:0),y:this.bounds.y+(i>=2?e:0),width:t,height:e},maxDepth:this.maxDepth,maxObjects:this.maxObjects}),this._s[i]._d=this._d+1,this._s[i]._p=this}}function ie(){return new ee(...arguments)}function se(t){let e=[];return t._dn?e.push(t._dn):t.children&&t.children.map(t=>{e=e.concat(se(t))}),e}ie.prototype=ee.prototype,ie.class=ee;class ne extends et.class{init({id:t,name:e=t,cullObjects:i=!0,cullFunction:s=B,...n}){const h=this._dn=document.createElement("section");h.tabIndex=-1,h.style=Q,h.id=t,h.setAttribute("aria-label",e),super.init({id:t,name:e,cullObjects:i,cullFunction:s,...n}),Z(h,this.context.canvas);let r=this.context.canvas;this.camera=et({x:r.width/2,y:r.height/2,width:r.width,height:r.height,anchor:{x:.5,y:.5}}),this.camera._pc=(()=>{super._pc.call(this.camera);this.context.canvas;this.camera._wx=this.camera.x*this.scaleX,this.camera._wy=this.camera.y*this.scaleY})}show(){this.hidden=this._dn.hidden=!1;let t=this.children.find(t=>t.focus);t?t.focus():this._dn.focus(),this.onShow()}hide(){this.hidden=this._dn.hidden=!0,this.onHide()}addChild(t,e){super.addChild(t,e),se(t).map(t=>{this._dn.appendChild(t)})}removeChild(t){super.removeChild(t),se(t).map(t=>{Z(t,this.context.canvas)})}destroy(){this._dn.remove(),this.children.map(t=>t.destroy&&t.destroy())}update(t){this.hidden||super.update(t)}lookAt(t){let e=(t=t.world||t).x,i=t.y;t.scaleX&&(e/=t.scaleX,i/=t.scaleY),this.camera.x=e,this.camera.y=i,this._pc()}_pc(){super._pc(),this.camera&&this.camera._pc()}render(){let{x:t,y:e,width:i,height:s}=this.camera;this.sx=t*this.scaleX-i/2,this.sy=e*this.scaleY-s/2,this.hidden||super.render(t=>!this.cullObjects||this.cullFunction(t,this.camera))}onShow(){}onHide(){}}function he(){return new ne(...arguments)}function re(t){if(+t===t)return t;let e=[],i=t.split(".."),s=+i[0],n=+i[1],h=s;if(s<n)for(;h<=n;h++)e.push(h);else for(;h>=n;h--)e.push(h);return e}he.prototype=ne.prototype,he.class=ne;class oe{constructor({image:t,frameWidth:e,frameHeight:i,frameMargin:s,animations:n}={}){if(!t)throw Error("You must provide an Image for the SpriteSheet");this.animations={},this.image=t,this.frame={width:e,height:i,margin:s},this._f=t.width/e|0,this.createAnimations(n)}createAnimations(t){let e,i;for(i in t){let{frames:s,frameRate:n,loop:h}=t[i];if(e=[],void 0===s)throw Error("Animation "+i+" must provide a frames property");[].concat(s).map(t=>{e=e.concat(re(t))}),this.animations[i]=d({spriteSheet:this,frames:e,frameRate:n,loop:h})}}}function ae(){return new oe(...arguments)}function ce(t){let{width:e,height:i,tilewidth:s,tileheight:n,context:h=o(),tilesets:a,layers:c}=t,d=e*s,l=i*n,u=document.createElement("canvas"),p=u.getContext("2d");u.width=d,u.height=l;let _={},f={},x=[],g=Object.assign({context:h,mapwidth:d,mapheight:l,_sx:0,_sy:0,_d:!1,get sx(){return this._sx},get sy(){return this._sy},set sx(t){this._sx=F(0,d-r().width,t),x.forEach(t=>t.sx=this._sx)},set sy(t){this._sy=F(0,l-r().height,t),x.forEach(t=>t.sy=this._sy)},render(){this._d&&(this._d=!1,this._p()),b(u)},renderLayer(t){let e=f[t],i=_[t];e||((e=document.createElement("canvas")).width=d,e.height=l,f[t]=e,g._r(i,e.getContext("2d"))),i._d&&(i._d=!1,e.getContext("2d").clearRect(0,0,e.width,e.height),g._r(i,e.getContext("2d"))),b(e)},layerCollidesWith(t,e){let{x:i,y:s,width:n,height:h}=K(e),r=w(s),o=m(i),a=w(s+h),c=m(i+n),d=_[t];for(let l=r;l<=a;l++)for(let t=o;t<=c;t++)if(d.data[t+l*this.width])return!0;return!1},tileAtLayer(t,e){let i=e.row||w(e.y),s=e.col||m(e.x);return _[t]?_[t].data[s+i*g.width]:-1},setTileAtLayer(t,e,i){let s=e.row||w(e.y),n=e.col||m(e.x);_[t]&&(this._d=!0,_[t]._d=!0,_[t].data[n+s*g.width]=i)},setLayer(t,e){_[t]&&(this._d=!0,_[t]._d=!0,_[t].data=e)},addObject(t){x.push(t),t.sx=this._sx,t.sy=this._sy},removeObject(t){let e=x.indexOf(t);-1!==e&&(x.splice(e,1),t.sx=t.sy=0)},_r:function(t,e){e.save(),e.globalAlpha=t.opacity,(t.data||[]).map((t,i)=>{if(!t)return;let s;for(let e=g.tilesets.length-1;e>=0&&(s=g.tilesets[e],!(t/s.firstgid>=1));e--);let n=s.tilewidth||g.tilewidth,h=s.tileheight||g.tileheight,r=s.margin||0,o=s.image,a=t-s.firstgid,c=s.columns||o.width/(n+r)|0,d=i%g.width*n,l=(i/g.width|0)*h,u=a%c*(n+r),p=(a/c|0)*(h+r);e.drawImage(o,u,p,n,h,d,l,n,h)}),e.restore()},_p:y,layerCanvases:f,layerMap:_},t);function w(t){return t/g.tileheight|0}function m(t){return t/g.tilewidth|0}function y(){g.layers&&g.layers.map(t=>{t._d=!1,_[t.name]=t,t.data&&!1!==t.visible&&g._r(t,p)})}function b(t){const{width:e,height:i}=r(),s=Math.min(t.width,e),n=Math.min(t.height,i);g.context.drawImage(t,g.sx,g.sy,s,n,0,0,s,n)}return g.tilesets.map(e=>{let i=(window.__k?window.__k.dm.get(t):"")||window.location.href;if(e.source){if(!window.__k)throw Error('You must use "load" or "loadData" to resolve tileset.source');let t=window.__k.d[window.__k.u(e.source,i)];if(!t)throw Error(`You must load the tileset source "${e.source}" before loading the tileset`);Object.keys(t).map(i=>{e[i]=t[i]})}if(""+e.image===e.image){if(!window.__k)throw Error('You must use "load" or "loadImage" to resolve tileset.image');let t=window.__k.i[window.__k.u(e.image,i)];if(!t)throw Error(`You must load the image "${e.image}" before loading the tileset`);e.image=t}}),y(),g}ae.prototype=oe.prototype,ae.class=oe;let de={Animation:d,imageAssets:S,audioAssets:j,dataAssets:E,setImagePath:k,setAudioPath:C,setDataPath:O,loadImage:M,loadAudio:L,loadData:I,load:Y,Button:Ot,init:a,getCanvas:r,getContext:o,on:s,off:n,emit:h,GameLoop:Lt,GameObject:et,Grid:Dt,degToRad:T,radToDeg:D,angleToTarget:X,rotatePoint:R,randInt:z,seedRand:N,lerp:W,inverseLerp:G,clamp:F,setStoreItem:U,getStoreItem:H,collides:B,getWorldRect:K,keyMap:zt,initKeys:Ft,bindKeys:Ut,unbindKeys:Ht,keyPressed:Bt,registerPlugin:qt,unregisterPlugin:Vt,extendObject:Jt,initPointer:vt,getPointer:ut,track:At,untrack:St,pointerOver:jt,onPointerDown:Et,onPointerUp:Pt,pointerPressed:kt,Pool:Zt,Quadtree:ie,Scene:he,Sprite:st,SpriteSheet:ae,Text:ot,TileEngine:ce,Vector:q};var le=de;exports.default=le;
},{}],"imji":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.emit=exports.allOff=exports.off=exports.on=exports.EV_GIVEQUEST=exports.EV_UPDATECONVOTRIGGER=exports.EV_INTERACTION=exports.EV_SCENECHANGE=exports.EV_CONVOCHOICE=exports.EV_CONVONEXT=exports.EV_CONVOEND=exports.EV_CONVOSTART=void 0;var o=require("kontra");const e="ev.convoStart";exports.EV_CONVOSTART=e;const t="ev.convoEnd";exports.EV_CONVOEND=t;const s="ev.convoNext";exports.EV_CONVONEXT=s;const r="ev.convoChoice";exports.EV_CONVOCHOICE=r;const n="ev.sceneChange";exports.EV_SCENECHANGE=n;const E="ev.onInteraction";exports.EV_INTERACTION=E;const p="ev.onUpdateConvoTrigger";exports.EV_UPDATECONVOTRIGGER=p;const O="ev.onGiveQuest";exports.EV_GIVEQUEST=O;let V={};const x=(e,t)=>{V[e]=t,(0,o.on)(e,V[e])};exports.on=x;const c=(e,t)=>(0,o.off)(e,t);exports.off=c;const C=function(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object.keys(V).map(e=>!o.some(o=>o===e)&&c(e,V[e]))};exports.allOff=C;const N=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,o.emit)(e,t)};exports.emit=N;
},{"kontra":"crkq"}],"bQKU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.debug=exports.Queue=exports.getRandomIntInclusive=exports.circleCollision=exports.sortByDist=exports.dist=exports.vmulti=exports.getNormal=exports.between=exports.uniqueId=void 0;var t=require("../common/events");const o=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(t).concat(t.length?"_":"")+(Number(String(Math.random()).slice(2))+Date.now()+Math.round(performance.now())).toString(36)};exports.uniqueId=o;const e=(t,o,e)=>t>o&&t<e;exports.between=e;const n=t=>{const o=Math.sqrt(t.x*t.x+t.y*t.y);return{x:0!==t.x?t.x/o:0,y:0!==t.y?t.y/o:0}};exports.getNormal=n;const s=(t,o)=>{let e=0,n=0;return"object"==typeof o?(e=t.x*o.x,n=t.y*o.y):(e=t.x*o,n=t.y*o),Vector(e,n)};exports.vmulti=s;const r=(t,o)=>{const e=t.x-o.x,n=t.y-o.y;return Math.sqrt(e*e+n*n)};exports.dist=r;const i=function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).sort((o,e)=>r(t,o.position)-r(t,e.position))};exports.sortByDist=i;const l=function(t,o){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t.radius||console.error("Cannot detect collisions without radius property."),o.filter(o=>{if(t.id===o.id)return;const n=o.collisionBodyOptions?{x:o.collisionBodyOptions.offsetX?o.x+o.collisionBodyOptions.offsetX:o.x,y:o.collisionBodyOptions.offsetY?o.y+o.collisionBodyOptions.offsetY:o.y}:{x:o.x,y:o.y};let s=n.x-t.x,r=n.y-t.y;return Math.sqrt(s*s+r*r)<o.radius+t.width?(o.ttl=e?0:o.ttl,o):void 0})};exports.circleCollision=l;const c=(t,o)=>(t=Math.ceil(t),o=Math.floor(o),Math.floor(Math.random()*(o-t+1)+t));exports.getRandomIntInclusive=c;const u=()=>{let t=[];return{elements:()=>t,enqueue:o=>t.push(o),dequeue:()=>t.length>0?t.shift():null,isEmpty:()=>0===t.length,length:()=>t.length,peek:()=>t.length>0?t[0]:null}};exports.Queue=u;const x=o=>{console.info(o),(0,t.emit)(t.EV_DEBUGLOG,o)};exports.debug=x;
},{"../common/events":"imji"}],"ni7Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ENTITY_TYPE=void 0;const e={FIXED:0,NPC:1,PICKUP:2,DOOR:3,PLAYER:99};exports.ENTITY_TYPE=e;
},{}],"NCDA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("kontra");function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,s)}return r}function r(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?e(Object(o),!0).forEach(function(e){s(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const o=()=>{console.info("Initialized store.");return{resetEntityStates:()=>{console.log("Entity states were reset."),(0,t.setStoreItem)("entities",[]),(0,t.setStoreItem)("quests",[])},pushProgress:e=>{const r=(0,t.getStoreItem)("progressData");r?(0,t.setStoreItem)("progressData",[...r,e]):(0,t.setStoreItem)("progressData",[])},updateProgress:e=>{const s=(0,t.getStoreItem)("progressData").map(t=>t.id===e.props.entityId?r(r({},t),{},{triggerConvo:e.props.id}):t);(0,t.setStoreItem)("progressData",s)},updateQuestData:e=>{const r=(0,t.getStoreItem)("quests");if(r){if(r.find(t=>t.id===e.id))throw new Error("You should not push the same quest data twice.");(0,t.setStoreItem)("quests",[...r,e])}else(0,t.setStoreItem)("quests",[e])},updateEntityData:e=>{const{id:r,type:s,ttl:o}=e,a=(0,t.getStoreItem)("entities"),n=a?a.find(t=>t.id===r):null;(0,t.setStoreItem)("entities",a?a.filter(t=>t.id!==r).concat([{id:r,type:s,ttl:o,qty:n?n.qty+1:1}]):[{id:r,type:s,ttl:o,qty:1}])},getMapData:e=>t.dataAssets[e],getWorldData:()=>t.dataAssets["assets/gameData/worldData.json"],getEntityData:()=>t.dataAssets["assets/gameData/entityData.json"],getProgressDataStore:()=>(0,t.getStoreItem)("progressData"),getEntityDataStore:()=>(0,t.getStoreItem)("entities"),getQuestDataStore:()=>{},getAllEntitiesOfType:e=>{const r=(0,t.getStoreItem)("entities");return r?r.filter(t=>t.type===e):[]},getEntityFromStore:e=>{const r=(0,t.getStoreItem)("entities");return r&&r.length?r.find(t=>t.id===e):null}}};var a=o();exports.default=a;
},{"kontra":"crkq"}],"y51D":[function(require,module,exports) {
"use strict";function e(e,o,n,r,i,t){return{tag:e,key:o,attrs:n,children:r,text:i,dom:t,domSize:void 0,state:void 0,events:void 0,instance:void 0}}e.normalize=function(o){return Array.isArray(o)?e("[",void 0,void 0,e.normalizeChildren(o),void 0,void 0):null==o||"boolean"==typeof o?null:"object"==typeof o?o:e("#",void 0,void 0,String(o),void 0,void 0)},e.normalizeChildren=function(o){var n=[];if(o.length){for(var r=null!=o[0]&&null!=o[0].key,i=1;i<o.length;i++)if((null!=o[i]&&null!=o[i].key)!==r)throw new TypeError("Vnodes must either always have keys or never have keys!");for(i=0;i<o.length;i++)n[i]=e.normalize(o[i])}return n},module.exports=e;
},{}],"skWM":[function(require,module,exports) {
"use strict";var r=require("../render/vnode");module.exports=function(){var e,t=arguments[this],s=this+1;if(null==t?t={}:("object"!=typeof t||null!=t.tag||Array.isArray(t))&&(t={},s=this),arguments.length===s+1)e=arguments[s],Array.isArray(e)||(e=[e]);else for(e=[];s<arguments.length;)e.push(arguments[s++]);return r("",t.key,t,e)};
},{"../render/vnode":"y51D"}],"l8ze":[function(require,module,exports) {
"use strict";var r=require("../render/vnode"),a=require("./hyperscriptVnode"),e=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,l={},t={}.hasOwnProperty;function s(r){for(var a in r)if(t.call(r,a))return!1;return!0}function n(r){for(var a,t="div",s=[],n={};a=e.exec(r);){var i=a[1],c=a[2];if(""===i&&""!==c)t=c;else if("#"===i)n.id=c;else if("."===i)s.push(c);else if("["===a[3][0]){var o=a[6];o&&(o=o.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===a[4]?s.push(o):n[a[4]]=""===o?o:o||!0}}return s.length>0&&(n.className=s.join(" ")),l[r]={tag:t,attrs:n}}function i(a,e){var l=e.attrs,n=r.normalizeChildren(e.children),i=t.call(l,"class"),c=i?l.class:l.className;if(e.tag=a.tag,e.attrs=null,e.children=void 0,!s(a.attrs)&&!s(l)){var o={};for(var u in l)t.call(l,u)&&(o[u]=l[u]);l=o}for(var u in a.attrs)t.call(a.attrs,u)&&"className"!==u&&!t.call(l,u)&&(l[u]=a.attrs[u]);for(var u in null==c&&null==a.attrs.className||(l.className=null!=c?null!=a.attrs.className?String(a.attrs.className)+" "+String(c):c:null!=a.attrs.className?a.attrs.className:null),i&&(l.class=null),l)if(t.call(l,u)&&"key"!==u){e.attrs=l;break}return Array.isArray(n)&&1===n.length&&null!=n[0]&&"#"===n[0].tag?e.text=n[0].children:e.children=n,e}function c(e){if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");var t=a.apply(1,arguments);return"string"==typeof e&&(t.children=r.normalizeChildren(t.children),"["!==e)?i(l[e]||n(e),t):(t.tag=e,t)}module.exports=c;
},{"../render/vnode":"y51D","./hyperscriptVnode":"skWM"}],"b5QZ":[function(require,module,exports) {
"use strict";var e=require("../render/vnode");module.exports=function(r){return null==r&&(r=""),e("<",void 0,void 0,r,void 0,void 0)};
},{"../render/vnode":"y51D"}],"HdGc":[function(require,module,exports) {
"use strict";var r=require("../render/vnode"),e=require("./hyperscriptVnode");module.exports=function(){var n=e.apply(0,arguments);return n.tag="[",n.children=r.normalizeChildren(n.children),n};
},{"../render/vnode":"y51D","./hyperscriptVnode":"skWM"}],"R2AL":[function(require,module,exports) {
"use strict";var r=require("./render/hyperscript");r.trust=require("./render/trust"),r.fragment=require("./render/fragment"),module.exports=r;
},{"./render/hyperscript":"l8ze","./render/trust":"b5QZ","./render/fragment":"HdGc"}],"EYVZ":[function(require,module,exports) {
"use strict";var n=function(t){if(!(this instanceof n))throw new Error("Promise must be called with `new`");if("function"!=typeof t)throw new TypeError("executor must be a function");var e=this,r=[],o=[],i=s(r,!0),c=s(o,!1),u=e._instance={resolvers:r,rejectors:o},f="function"==typeof setImmediate?setImmediate:setTimeout;function s(n,t){return function i(s){var h;try{if(!t||null==s||"object"!=typeof s&&"function"!=typeof s||"function"!=typeof(h=s.then))f(function(){t||0!==n.length||console.error("Possible unhandled promise rejection:",s);for(var e=0;e<n.length;e++)n[e](s);r.length=0,o.length=0,u.state=t,u.retry=function(){i(s)}});else{if(s===e)throw new TypeError("Promise can't be resolved w/ itself");l(h.bind(s))}}catch(a){c(a)}}}function l(n){var t=0;function e(n){return function(e){t++>0||n(e)}}var r=e(c);try{n(e(i),r)}catch(o){r(o)}}l(t)};n.prototype.then=function(t,e){var r,o,i=this._instance;function c(n,t,e,c){t.push(function(t){if("function"!=typeof n)e(t);else try{r(n(t))}catch(i){o&&o(i)}}),"function"==typeof i.retry&&c===i.state&&i.retry()}var u=new n(function(n,t){r=n,o=t});return c(t,i.resolvers,r,!0),c(e,i.rejectors,o,!1),u},n.prototype.catch=function(n){return this.then(null,n)},n.prototype.finally=function(t){return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})},n.resolve=function(t){return t instanceof n?t:new n(function(n){n(t)})},n.reject=function(t){return new n(function(n,e){e(t)})},n.all=function(t){return new n(function(n,e){var r=t.length,o=0,i=[];if(0===t.length)n([]);else for(var c=0;c<t.length;c++)!function(c){function u(t){o++,i[c]=t,o===r&&n(i)}null==t[c]||"object"!=typeof t[c]&&"function"!=typeof t[c]||"function"!=typeof t[c].then?u(t[c]):t[c].then(u,e)}(c)})},n.race=function(t){return new n(function(n,e){for(var r=0;r<t.length;r++)t[r].then(n,e)})},module.exports=n;
},{}],"PcbK":[function(require,module,exports) {
var global = arguments[3];
var o=arguments[3],e=require("./polyfill");"undefined"!=typeof window?(void 0===window.Promise?window.Promise=e:window.Promise.prototype.finally||(window.Promise.prototype.finally=e.prototype.finally),module.exports=window.Promise):void 0!==o?(void 0===o.Promise?o.Promise=e:o.Promise.prototype.finally||(o.Promise.prototype.finally=e.prototype.finally),module.exports=o.Promise):module.exports=e;
},{"./polyfill":"EYVZ"}],"oGTt":[function(require,module,exports) {
"use strict";var e=require("../render/vnode");module.exports=function(t){var n,l=t&&t.document,o={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function r(e){return e.attrs&&e.attrs.xmlns||o[e.tag]}function i(e,t){if(e.state!==t)throw new Error("`vnode.state` must not be modified")}function a(e){var t=e.state;try{return this.apply(t,arguments)}finally{i(e,t)}}function u(){try{return l.activeElement}catch(e){return null}}function s(e,t,n,l,o,r,i){for(var a=n;a<l;a++){var u=t[a];null!=u&&f(e,u,o,i,r)}}function f(t,n,o,i,u){var d=n.tag;if("string"==typeof d)switch(n.state={},null!=n.attrs&&D(n.attrs,n,o),d){case"#":!function(e,t,n){t.dom=l.createTextNode(t.children),b(e,t.dom,n)}(t,n,u);break;case"<":c(t,n,i,u);break;case"[":!function(e,t,n,o,r){var i=l.createDocumentFragment();if(null!=t.children){var a=t.children;s(i,a,0,a.length,n,null,o)}t.dom=i.firstChild,t.domSize=i.childNodes.length,b(e,i,r)}(t,n,o,i,u);break;default:!function(t,n,o,i,a){var u=n.tag,f=n.attrs,d=f&&f.is,c=(i=r(n)||i)?d?l.createElementNS(i,u,{is:d}):l.createElementNS(i,u):d?l.createElement(u,{is:d}):l.createElement(u);n.dom=c,null!=f&&function(e,t,n){for(var l in t)z(e,l,null,t[l],n)}(n,f,i);if(b(t,c,a),!w(n)&&(null!=n.text&&(""!==n.text?c.textContent=n.text:n.children=[e("#",void 0,void 0,n.text,void 0,void 0)]),null!=n.children)){var v=n.children;s(c,v,0,v.length,o,null,i),"select"===n.tag&&null!=f&&function(e,t){if("value"in t)if(null===t.value)-1!==e.dom.selectedIndex&&(e.dom.value=null);else{var n=""+t.value;e.dom.value===n&&-1!==e.dom.selectedIndex||(e.dom.value=n)}"selectedIndex"in t&&z(e,"selectedIndex",null,t.selectedIndex,void 0)}(n,f)}}(t,n,o,i,u)}else!function(t,n,l,o,r){(function(t,n){var l;if("function"==typeof t.tag.view){if(t.state=Object.create(t.tag),null!=(l=t.state.view).$$reentrantLock$$)return;l.$$reentrantLock$$=!0}else{if(t.state=void 0,null!=(l=t.tag).$$reentrantLock$$)return;l.$$reentrantLock$$=!0,t.state=null!=t.tag.prototype&&"function"==typeof t.tag.prototype.view?new t.tag(t):t.tag(t)}if(D(t.state,t,n),null!=t.attrs&&D(t.attrs,t,n),t.instance=e.normalize(a.call(t.state.view,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");l.$$reentrantLock$$=null})(n,l),null!=n.instance?(f(t,n.instance,l,o,r),n.dom=n.instance.dom,n.domSize=null!=n.dom?n.instance.domSize:0):n.domSize=0}(t,n,o,i,u)}var d={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function c(e,t,n,o){var r=t.children.match(/^\s*?<(\w+)/im)||[],i=l.createElement(d[r[1]]||"div");"http://www.w3.org/2000/svg"===n?(i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",i=i.firstChild):i.innerHTML=t.children,t.dom=i.firstChild,t.domSize=i.childNodes.length,t.instance=[];for(var a,u=l.createDocumentFragment();a=i.firstChild;)t.instance.push(a),u.appendChild(a);b(e,u,o)}function v(e,t,n,l,o,r){if(t!==n&&(null!=t||null!=n))if(null==t||0===t.length)s(e,n,0,n.length,l,o,r);else if(null==n||0===n.length)x(e,t,0,t.length);else{var i=null!=t[0]&&null!=t[0].key,a=null!=n[0]&&null!=n[0].key,u=0,d=0;if(!i)for(;d<t.length&&null==t[d];)d++;if(!a)for(;u<n.length&&null==n[u];)u++;if(null===a&&null==i)return;if(i!==a)x(e,t,d,t.length),s(e,n,u,n.length,l,o,r);else if(a){for(var c,v,b,w,S,E=t.length-1,$=n.length-1;E>=d&&$>=u&&(b=t[E],w=n[$],b.key===w.key);)b!==w&&m(e,b,w,l,o,r),null!=w.dom&&(o=w.dom),E--,$--;for(;E>=d&&$>=u&&(c=t[d],v=n[u],c.key===v.key);)d++,u++,c!==v&&m(e,c,v,l,p(t,d,o),r);for(;E>=d&&$>=u&&u!==$&&c.key===w.key&&b.key===v.key;)y(e,b,S=p(t,d,o)),b!==v&&m(e,b,v,l,S,r),++u<=--$&&y(e,c,o),c!==w&&m(e,c,w,l,o,r),null!=w.dom&&(o=w.dom),d++,b=t[--E],w=n[$],c=t[d],v=n[u];for(;E>=d&&$>=u&&b.key===w.key;)b!==w&&m(e,b,w,l,o,r),null!=w.dom&&(o=w.dom),$--,b=t[--E],w=n[$];if(u>$)x(e,t,d,E+1);else if(d>E)s(e,n,u,$+1,l,o,r);else{var z,C,A=o,L=$-u+1,N=new Array(L),T=0,j=0,I=2147483647,M=0;for(j=0;j<L;j++)N[j]=-1;for(j=$;j>=u;j--){null==z&&(z=h(t,d,E+1));var O=z[(w=n[j]).key];null!=O&&(I=O<I?O:-1,N[j-u]=O,b=t[O],t[O]=null,b!==w&&m(e,b,w,l,o,r),null!=w.dom&&(o=w.dom),M++)}if(o=A,M!==E-d+1&&x(e,t,d,E+1),0===M)s(e,n,u,$+1,l,o,r);else if(-1===I)for(T=(C=function(e){for(var t=[0],n=0,l=0,o=0,r=g.length=e.length,o=0;o<r;o++)g[o]=e[o];for(var o=0;o<r;++o)if(-1!==e[o]){var i=t[t.length-1];if(e[i]<e[o])g[o]=i,t.push(o);else{for(n=0,l=t.length-1;n<l;){var a=(n>>>1)+(l>>>1)+(n&l&1);e[t[a]]<e[o]?n=a+1:l=a}e[o]<e[t[n]]&&(n>0&&(g[o]=t[n-1]),t[n]=o)}}n=t.length,l=t[n-1];for(;n-- >0;)t[n]=l,l=g[l];return g.length=0,t}(N)).length-1,j=$;j>=u;j--)v=n[j],-1===N[j-u]?f(e,v,l,r,o):C[T]===j-u?T--:y(e,v,o),null!=v.dom&&(o=n[j].dom);else for(j=$;j>=u;j--)v=n[j],-1===N[j-u]&&f(e,v,l,r,o),null!=v.dom&&(o=n[j].dom)}}else{var D=t.length<n.length?t.length:n.length;for(u=u<d?u:d;u<D;u++)(c=t[u])===(v=n[u])||null==c&&null==v||(null==c?f(e,v,l,r,p(t,u+1,o)):null==v?k(e,c):m(e,c,v,l,p(t,u+1,o),r));t.length>D&&x(e,t,u,t.length),n.length>D&&s(e,n,u,n.length,l,o,r)}}}function m(t,n,l,o,i,u){var s=n.tag;if(s===l.tag){if(l.state=n.state,l.events=n.events,function(e,t){do{if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate){var n=a.call(e.attrs.onbeforeupdate,e,t);if(void 0!==n&&!n)break}if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate){var n=a.call(e.state.onbeforeupdate,e,t);if(void 0!==n&&!n)break}return!1}while(0);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,!0}(l,n))return;if("string"==typeof s)switch(null!=l.attrs&&F(l.attrs,l,o),s){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children);t.dom=e.dom}(n,l);break;case"<":!function(e,t,n,l,o){t.children!==n.children?(S(e,t),c(e,n,l,o)):(n.dom=t.dom,n.domSize=t.domSize,n.instance=t.instance)}(t,n,l,u,i);break;case"[":!function(e,t,n,l,o,r){v(e,t.children,n.children,l,o,r);var i=0,a=n.children;if(n.dom=null,null!=a){for(var u=0;u<a.length;u++){var s=a[u];null!=s&&null!=s.dom&&(null==n.dom&&(n.dom=s.dom),i+=s.domSize||1)}1!==i&&(n.domSize=i)}}(t,n,l,o,i,u);break;default:!function(t,n,l,o){var i=n.dom=t.dom;o=r(n)||o,"textarea"===n.tag&&(null==n.attrs&&(n.attrs={}),null!=n.text&&(n.attrs.value=n.text,n.text=void 0));(function(e,t,n,l){if(null!=n)for(var o in n)z(e,o,t&&t[o],n[o],l);var r;if(null!=t)for(var o in t)null==(r=t[o])||null!=n&&null!=n[o]||C(e,o,r,l)})(n,t.attrs,n.attrs,o),w(n)||(null!=t.text&&null!=n.text&&""!==n.text?t.text.toString()!==n.text.toString()&&(t.dom.firstChild.nodeValue=n.text):(null!=t.text&&(t.children=[e("#",void 0,void 0,t.text,void 0,t.dom.firstChild)]),null!=n.text&&(n.children=[e("#",void 0,void 0,n.text,void 0,void 0)]),v(i,t.children,n.children,l,null,o)))}(n,l,o,u)}else!function(t,n,l,o,r,i){if(l.instance=e.normalize(a.call(l.state.view,l)),l.instance===l)throw Error("A view cannot return the vnode it received as argument");F(l.state,l,o),null!=l.attrs&&F(l.attrs,l,o);null!=l.instance?(null==n.instance?f(t,l.instance,o,i,r):m(t,n.instance,l.instance,o,r,i),l.dom=l.instance.dom,l.domSize=l.instance.domSize):null!=n.instance?(k(t,n.instance),l.dom=void 0,l.domSize=0):(l.dom=n.dom,l.domSize=n.domSize)}(t,n,l,o,i,u)}else k(t,n),f(t,l,o,u,i)}function h(e,t,n){for(var l=Object.create(null);t<n;t++){var o=e[t];if(null!=o){var r=o.key;null!=r&&(l[r]=t)}}return l}var g=[];function p(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function y(e,t,n){var o=l.createDocumentFragment();!function e(t,n,l){for(;null!=l.dom&&l.dom.parentNode===t;){if("string"!=typeof l.tag){if(null!=(l=l.instance))continue}else if("<"===l.tag)for(var o=0;o<l.instance.length;o++)n.appendChild(l.instance[o]);else if("["!==l.tag)n.appendChild(l.dom);else if(1===l.children.length){if(null!=(l=l.children[0]))continue}else for(var o=0;o<l.children.length;o++){var r=l.children[o];null!=r&&e(t,n,r)}break}}(e,o,t),b(e,o,n)}function b(e,t,n){null!=n?e.insertBefore(t,n):e.appendChild(t)}function w(e){if(null==e.attrs||null==e.attrs.contenteditable&&null==e.attrs.contentEditable)return!1;var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=e.text||null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted");return!0}function x(e,t,n,l){for(var o=n;o<l;o++){var r=t[o];null!=r&&k(e,r)}}function k(e,t){var n,l,o,r=0,u=t.state;"string"!=typeof t.tag&&"function"==typeof t.state.onbeforeremove&&(null!=(o=a.call(t.state.onbeforeremove,t))&&"function"==typeof o.then&&(r=1,n=o));t.attrs&&"function"==typeof t.attrs.onbeforeremove&&(null!=(o=a.call(t.attrs.onbeforeremove,t))&&"function"==typeof o.then&&(r|=2,l=o));if(i(t,u),r){if(null!=n){var s=function(){1&r&&((r&=2)||f())};n.then(s,s)}if(null!=l){s=function(){2&r&&((r&=1)||f())};l.then(s,s)}}else $(t),E(e,t);function f(){i(t,u),$(t),E(e,t)}}function S(e,t){for(var n=0;n<t.instance.length;n++)e.removeChild(t.instance[n])}function E(e,t){for(;null!=t.dom&&t.dom.parentNode===e;){if("string"!=typeof t.tag){if(null!=(t=t.instance))continue}else if("<"===t.tag)S(e,t);else{if("["!==t.tag&&(e.removeChild(t.dom),!Array.isArray(t.children)))break;if(1===t.children.length){if(null!=(t=t.children[0]))continue}else for(var n=0;n<t.children.length;n++){var l=t.children[n];null!=l&&E(e,l)}}break}}function $(e){if("string"!=typeof e.tag&&"function"==typeof e.state.onremove&&a.call(e.state.onremove,e),e.attrs&&"function"==typeof e.attrs.onremove&&a.call(e.attrs.onremove,e),"string"!=typeof e.tag)null!=e.instance&&$(e.instance);else{var t=e.children;if(Array.isArray(t))for(var n=0;n<t.length;n++){var l=t[n];null!=l&&$(l)}}}function z(e,t,n,o,r){if("key"!==t&&"is"!==t&&null!=o&&!A(t)&&(n!==o||function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===u()||"option"===e.tag&&e.dom.parentNode===l.activeElement}(e,t)||"object"==typeof o)){if("o"===t[0]&&"n"===t[1])return O(e,t,o);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),o);else if("style"===t)I(e.dom,n,o);else if(L(e,t,r)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+o&&e.dom===u())return;if("select"===e.tag&&null!==n&&e.dom.value===""+o)return;if("option"===e.tag&&null!==n&&e.dom.value===""+o)return}"input"===e.tag&&"type"===t?e.dom.setAttribute(t,o):e.dom[t]=o}else"boolean"==typeof o?o?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,o)}}function C(e,t,n,l){if("key"!==t&&"is"!==t&&null!=n&&!A(t))if("o"!==t[0]||"n"!==t[1]||A(t))if("style"===t)I(e.dom,n,null);else if(!L(e,t,l)||"className"===t||"value"===t&&("option"===e.tag||"select"===e.tag&&-1===e.dom.selectedIndex&&e.dom===u())||"input"===e.tag&&"type"===t){var o=t.indexOf(":");-1!==o&&(t=t.slice(o+1)),!1!==n&&e.dom.removeAttribute("className"===t?"class":t)}else e.dom[t]=null;else O(e,t,void 0)}function A(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function L(e,t,n){return void 0===n&&(e.tag.indexOf("-")>-1||null!=e.attrs&&e.attrs.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}var N=/[A-Z]/g;function T(e){return"-"+e.toLowerCase()}function j(e){return"-"===e[0]&&"-"===e[1]?e:"cssFloat"===e?"float":e.replace(N,T)}function I(e,t,n){if(t===n);else if(null==n)e.style.cssText="";else if("object"!=typeof n)e.style.cssText=n;else if(null==t||"object"!=typeof t)for(var l in e.style.cssText="",n){null!=(o=n[l])&&e.style.setProperty(j(l),String(o))}else{for(var l in n){var o;null!=(o=n[l])&&(o=String(o))!==String(t[l])&&e.style.setProperty(j(l),o)}for(var l in t)null!=t[l]&&null==n[l]&&e.style.removeProperty(j(l))}}function M(){this._=n}function O(e,t,n){if(null!=e.events){if(e.events[t]===n)return;null==n||"function"!=typeof n&&"object"!=typeof n?(null!=e.events[t]&&e.dom.removeEventListener(t.slice(2),e.events,!1),e.events[t]=void 0):(null==e.events[t]&&e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}else null==n||"function"!=typeof n&&"object"!=typeof n||(e.events=new M,e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}function D(e,t,n){"function"==typeof e.oninit&&a.call(e.oninit,t),"function"==typeof e.oncreate&&n.push(a.bind(e.oncreate,t))}function F(e,t,n){"function"==typeof e.onupdate&&n.push(a.bind(e.onupdate,t))}return M.prototype=Object.create(null),M.prototype.handleEvent=function(e){var t,n=this["on"+e.type];"function"==typeof n?t=n.call(e.currentTarget,e):"function"==typeof n.handleEvent&&n.handleEvent(e),this._&&!1!==e.redraw&&(0,this._)(),!1===t&&(e.preventDefault(),e.stopPropagation())},function(t,l,o){if(!t)throw new TypeError("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var r=[],i=u(),a=t.namespaceURI;null==t.vnodes&&(t.textContent=""),l=e.normalizeChildren(Array.isArray(l)?l:[l]);var s=n;try{n="function"==typeof o?o:void 0,v(t,t.vnodes,l,r,null,"http://www.w3.org/1999/xhtml"===a?void 0:a)}finally{n=s}t.vnodes=l,null!=i&&u()!==i&&"function"==typeof i.focus&&i.focus();for(var f=0;f<r.length;f++)r[f]()}};
},{"../render/vnode":"y51D"}],"knD4":[function(require,module,exports) {
"use strict";module.exports=require("./render/render")(window);
},{"./render/render":"oGTt"}],"Lt2a":[function(require,module,exports) {
"use strict";var n=require("../render/vnode");module.exports=function(e,r,o){var t=[],c=!1,u=!1;function i(){if(c)throw new Error("Nested m.redraw.sync() call");c=!0;for(var r=0;r<t.length;r+=2)try{e(t[r],n(t[r+1]),l)}catch(u){o.error(u)}c=!1}function l(){u||(u=!0,r(function(){u=!1,i()}))}return l.sync=i,{mount:function(r,o){if(null!=o&&null==o.view&&"function"!=typeof o)throw new TypeError("m.mount(element, component) expects a component, not a vnode");var c=t.indexOf(r);c>=0&&(t.splice(c,2),e(r,[],l)),null!=o&&(t.push(r,o),e(r,n(o),l))},redraw:l}};
},{"../render/vnode":"y51D"}],"JmBI":[function(require,module,exports) {
"use strict";var e=require("./render");module.exports=require("./api/mount-redraw")(e,requestAnimationFrame,console);
},{"./render":"knD4","./api/mount-redraw":"Lt2a"}],"e1pw":[function(require,module,exports) {
"use strict";module.exports=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t=[];for(var o in e)r(o,e[o]);return t.join("&");function r(e,o){if(Array.isArray(o))for(var n=0;n<o.length;n++)r(e+"["+n+"]",o[n]);else if("[object Object]"===Object.prototype.toString.call(o))for(var n in o)r(e+"["+n+"]",o[n]);else t.push(encodeURIComponent(e)+(null!=o&&""!==o?"="+encodeURIComponent(o):""))}};
},{}],"TIRB":[function(require,module,exports) {
"use strict";module.exports=Object.assign||function(t,c){c&&Object.keys(c).forEach(function(e){t[e]=c[e]})};
},{}],"bE7V":[function(require,module,exports) {
"use strict";var e=require("../querystring/build"),r=require("./assign");module.exports=function(n,t){if(/:([^\/\.-]+)(\.{3})?:/.test(n))throw new SyntaxError("Template parameter names *must* be separated");if(null==t)return n;var i=n.indexOf("?"),l=n.indexOf("#"),s=l<0?n.length:l,u=i<0?s:i,a=n.slice(0,u),c={};r(c,t);var d=a.replace(/:([^\/\.-]+)(\.{3})?/g,function(e,r,n){return delete c[r],null==t[r]?e:n?t[r]:encodeURIComponent(String(t[r]))}),o=d.indexOf("?"),f=d.indexOf("#"),g=f<0?d.length:f,m=o<0?g:o,p=d.slice(0,m);i>=0&&(p+=n.slice(i,s)),o>=0&&(p+=(i<0?"?":"&")+d.slice(o,g));var x=e(c);return x&&(p+=(i<0&&o<0?"?":"&")+x),l>=0&&(p+=n.slice(l)),f>=0&&(p+=(l<0?"":"&")+d.slice(f)),p};
},{"../querystring/build":"e1pw","./assign":"TIRB"}],"Nv5j":[function(require,module,exports) {
"use strict";var e=require("../pathname/build");module.exports=function(t,n,r){var o=0;function a(e){return new n(e)}function i(t){return function(o,i){"string"!=typeof o?(i=o,o=o.url):null==i&&(i={});var s=new n(function(n,r){t(e(o,i.params),i,function(e){if("function"==typeof i.type)if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t]=new i.type(e[t]);else e=new i.type(e);n(e)},r)});if(!0===i.background)return s;var c=0;function u(){0==--c&&"function"==typeof r&&r()}return function e(t){var n=t.then;t.constructor=a;t.then=function(){c++;var r=n.apply(t,arguments);return r.then(u,function(e){if(u(),0===c)throw e}),e(r)};return t}(s)}}function s(e,t){for(var n in e.headers)if({}.hasOwnProperty.call(e.headers,n)&&t.test(n))return!0;return!1}return a.prototype=n.prototype,a.__proto__=n,{request:i(function(e,n,r,o){var a,i=null!=n.method?n.method.toUpperCase():"GET",c=n.body,u=!(null!=n.serialize&&n.serialize!==JSON.serialize||c instanceof t.FormData),p=n.responseType||("function"==typeof n.extract?"":"json"),f=new t.XMLHttpRequest,l=!1,d=f,y=f.abort;for(var h in f.abort=function(){l=!0,y.call(this)},f.open(i,e,!1!==n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),u&&null!=c&&!s(n,/^content-type$/i)&&f.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof n.deserialize||s(n,/^accept$/i)||f.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(f.withCredentials=n.withCredentials),n.timeout&&(f.timeout=n.timeout),f.responseType=p,n.headers)({}).hasOwnProperty.call(n.headers,h)&&f.setRequestHeader(h,n.headers[h]);f.onreadystatechange=function(t){if(!l&&4===t.target.readyState)try{var a,i=t.target.status>=200&&t.target.status<300||304===t.target.status||/^file:\/\//i.test(e),s=t.target.response;if("json"===p?t.target.responseType||"function"==typeof n.extract||(s=JSON.parse(t.target.responseText)):p&&"text"!==p||null==s&&(s=t.target.responseText),"function"==typeof n.extract?(s=n.extract(t.target,n),i=!0):"function"==typeof n.deserialize&&(s=n.deserialize(s)),i)r(s);else{try{a=t.target.responseText}catch(u){a=s}var c=new Error(a);c.code=t.target.status,c.response=s,o(c)}}catch(u){o(u)}},"function"==typeof n.config&&(f=n.config(f,n,e)||f)!==d&&(a=f.abort,f.abort=function(){l=!0,a.call(this)}),null==c?f.send():"function"==typeof n.serialize?f.send(n.serialize(c)):c instanceof t.FormData?f.send(c):f.send(JSON.stringify(c))}),jsonp:i(function(e,n,r,a){var i=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+o++,s=t.document.createElement("script");t[i]=function(e){delete t[i],s.parentNode.removeChild(s),r(e)},s.onerror=function(){delete t[i],s.parentNode.removeChild(s),a(new Error("JSONP request failed"))},s.src=e+(e.indexOf("?")<0?"?":"&")+encodeURIComponent(n.callbackKey||"callback")+"="+encodeURIComponent(i),t.document.documentElement.appendChild(s)})}};
},{"../pathname/build":"bE7V"}],"JA2T":[function(require,module,exports) {
"use strict";var e=require("./promise/promise"),r=require("./mount-redraw");module.exports=require("./request/request")(window,e,r.redraw);
},{"./promise/promise":"PcbK","./mount-redraw":"JmBI","./request/request":"Nv5j"}],"Pflx":[function(require,module,exports) {
"use strict";module.exports=function(e){if(""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));for(var r=e.split("&"),t={},l={},n=0;n<r.length;n++){var o=r[n].split("="),i=decodeURIComponent(o[0]),s=2===o.length?decodeURIComponent(o[1]):"";"true"===s?s=!0:"false"===s&&(s=!1);var a=i.split(/\]\[?|\[/),p=l;i.indexOf("[")>-1&&a.pop();for(var u=0;u<a.length;u++){var c=a[u],f=a[u+1],v=""==f||!isNaN(parseInt(f,10));if(""===c)null==t[i=a.slice(0,u).join()]&&(t[i]=Array.isArray(p)?p.length:0),c=t[i]++;else if("__proto__"===c)break;if(u===a.length-1)p[c]=s;else{var d=Object.getOwnPropertyDescriptor(p,c);null!=d&&(d=d.value),null==d&&(p[c]=d=v?[]:{}),p=d}}}return l};
},{}],"Z9Pf":[function(require,module,exports) {
"use strict";var e=require("../querystring/parse");module.exports=function(r){var t=r.indexOf("?"),i=r.indexOf("#"),n=i<0?r.length:i,s=t<0?n:t,l=r.slice(0,s).replace(/\/{2,}/g,"/");return l?("/"!==l[0]&&(l="/"+l),l.length>1&&"/"===l[l.length-1]&&(l=l.slice(0,-1))):l="/",{path:l,params:t<0?{}:e(r.slice(t+1,n))}};
},{"../querystring/parse":"Pflx"}],"LcIX":[function(require,module,exports) {
"use strict";var r=require("./parse");module.exports=function(e){var t=r(e),n=Object.keys(t.params),a=[],u=new RegExp("^"+t.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(r,e,t){return null==e?"\\"+r:(a.push({k:e,r:"..."===t}),"..."===t?"(.*)":"."===t?"([^/]+)\\.":"([^/]+)"+(t||""))})+"$");return function(r){for(var e=0;e<n.length;e++)if(t.params[n[e]]!==r.params[n[e]])return!1;if(!a.length)return u.test(r.path);var p=u.exec(r.path);if(null==p)return!1;for(e=0;e<a.length;e++)r.params[a[e].k]=a[e].r?p[e+1]:decodeURIComponent(p[e+1]);return!0}};
},{"./parse":"Z9Pf"}],"rSj3":[function(require,module,exports) {
"use strict";var e=require("../render/vnode"),t=require("../render/hyperscript"),r=require("../promise/promise"),n=require("../pathname/build"),o=require("../pathname/parse"),a=require("../pathname/compileTemplate"),i=require("../pathname/assign"),u={};module.exports=function(l,c){var s;function f(e,t,r){if(e=n(e,t),null!=s){s();var o=r?r.state:null,a=r?r.title:null;r&&r.replace?l.history.replaceState(o,a,w.prefix+e):l.history.pushState(o,a,w.prefix+e)}else l.location.href=w.prefix+e}var p,h,d,m,v=u,y=w.SKIP={};function w(t,n,g){if(null==t)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var x,E=0,b=Object.keys(g).map(function(e){if("/"!==e[0])throw new SyntaxError("Routes must start with a `/`");if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Route parameter names must be separated with either `/`, `.`, or `-`");return{route:e,component:g[e],check:a(e)}}),k="function"==typeof setImmediate?setImmediate:setTimeout,q=r.resolve(),S=!1;if(s=null,null!=n){var K=o(n);if(!b.some(function(e){return e.check(K)}))throw new ReferenceError("Default route doesn't match any known routes")}function L(){S=!1;var e=l.location.hash;"#"!==w.prefix[0]&&(e=l.location.search+e,"?"!==w.prefix[0]&&"/"!==(e=l.location.pathname+e)[0]&&(e="/"+e));var t=e.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent).slice(w.prefix.length),r=o(t);function a(){if(t===n)throw new Error("Could not resolve default route "+n);f(n,null,{replace:!0})}i(r.params,l.history.state),function e(n){for(;n<b.length;n++)if(b[n].check(r)){var o=b[n].component,i=b[n].route,u=o,l=m=function(a){if(l===m){if(a===y)return e(n+1);p=null==a||"function"!=typeof a.view&&"function"!=typeof a?"div":a,h=r.params,d=t,m=null,v=o.render?o:null,2===E?c.redraw():(E=2,c.redraw.sync())}};return void(o.view||"function"==typeof o?(o={},l(u)):o.onmatch?q.then(function(){return o.onmatch(r.params,t,i)}).then(l,a):l("div"))}a()}(0)}return s=function(){S||(S=!0,k(L))},"function"==typeof l.history.pushState?(x=function(){l.removeEventListener("popstate",s,!1)},l.addEventListener("popstate",s,!1)):"#"===w.prefix[0]&&(s=null,x=function(){l.removeEventListener("hashchange",L,!1)},l.addEventListener("hashchange",L,!1)),c.mount(t,{onbeforeupdate:function(){return!(!(E=E?2:1)||u===v)},oncreate:L,onremove:x,view:function(){if(E&&u!==v){var t=[e(p,h.key,h)];return v&&(t=v.render(t[0])),t}}})}return w.set=function(e,t,r){null!=m&&((r=r||{}).replace=!0),m=null,f(e,t,r)},w.get=function(){return d},w.prefix="#!",w.Link={view:function(e){var r,n,o=e.attrs.options,a={};i(a,e.attrs),a.selector=a.options=a.key=a.oninit=a.oncreate=a.onbeforeupdate=a.onupdate=a.onbeforeremove=a.onremove=null;var u=t(e.attrs.selector||"a",a,e.children);return(u.attrs.disabled=Boolean(u.attrs.disabled))?(u.attrs.href=null,u.attrs["aria-disabled"]="true",u.attrs.onclick=null):(r=u.attrs.onclick,n=u.attrs.href,u.attrs.href=w.prefix+n,u.attrs.onclick=function(e){var t;"function"==typeof r?t=r.call(e.currentTarget,e):null==r||"object"!=typeof r||"function"==typeof r.handleEvent&&r.handleEvent(e),!1===t||e.defaultPrevented||0!==e.button&&0!==e.which&&1!==e.which||e.currentTarget.target&&"_self"!==e.currentTarget.target||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(e.preventDefault(),e.redraw=!1,w.set(n,null,o))}),u}},w.param=function(e){return h&&null!=e?h[e]:h},w};
},{"../render/vnode":"y51D","../render/hyperscript":"l8ze","../promise/promise":"PcbK","../pathname/build":"bE7V","../pathname/parse":"Z9Pf","../pathname/compileTemplate":"LcIX","../pathname/assign":"TIRB"}],"cTg1":[function(require,module,exports) {
"use strict";var r=require("./mount-redraw");module.exports=require("./api/router")(window,r);
},{"./mount-redraw":"JmBI","./api/router":"rSj3"}],"Vx2X":[function(require,module,exports) {
"use strict";var r=require("./hyperscript"),e=require("./request"),u=require("./mount-redraw"),t=function(){return r.apply(this,arguments)};t.m=r,t.trust=r.trust,t.fragment=r.fragment,t.mount=u.mount,t.route=require("./route"),t.render=require("./render"),t.redraw=u.redraw,t.request=e.request,t.jsonp=e.jsonp,t.parseQueryString=require("./querystring/parse"),t.buildQueryString=require("./querystring/build"),t.parsePathname=require("./pathname/parse"),t.buildPathname=require("./pathname/build"),t.vnode=require("./render/vnode"),t.PromisePolyfill=require("./promise/polyfill"),module.exports=t;
},{"./hyperscript":"R2AL","./request":"JA2T","./mount-redraw":"JmBI","./route":"cTg1","./render":"knD4","./querystring/parse":"Pflx","./querystring/build":"e1pw","./pathname/parse":"Z9Pf","./pathname/build":"bE7V","./render/vnode":"y51D","./promise/polyfill":"EYVZ"}],"LhRf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.typeWriter=void 0;const e=e=>{let{text:t,onStart:r=(()=>{}),onTyped:n=(e=>{}),onFinished:i=(()=>{})}=e,o="",a="";r();return{start:()=>o=requestAnimationFrame(()=>(function e(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(s>t.length)return cancelAnimationFrame(o),void i();a=r+t.charAt(s),s+=1,n(a),requestAnimationFrame(()=>e(a,s))})())}};exports.typeWriter=e;
},{}],"f6vQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("mithril")),t=require("./effects");function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let c=!1,l=!1,a="",i="",d=[];const s=t=>{a=t.name,i="",d=[],e.default.redraw()},f=r=>(0,t.typeWriter)({text:r.text,onStart:()=>l=!0,onTyped:t=>{i=t,e.default.redraw()},onFinished:()=>{l=!1,d=r.choices.length?r.choices:[],e.default.redraw()}}).start(),p=e=>{l||(s(e),f(e))},b=t=>{let{attrs:r}=t;return{oninit:()=>c=!0,onremove:()=>{c=!1,l=!1,a="",i="",d=[]},view:()=>(0,e.default)("div",{class:"uiShell"},i&&(0,e.default)("div",{class:"dialogueBoxOuter"},[(0,e.default)("div",{class:"dialogue"},[(0,e.default)("span",a?"".concat(a,":"):""),(0,e.default)("span",a?'"'.concat(i,'"'):i),(0,e.default)("div",{class:"choiceWindow"},d.map(t=>(0,e.default)("button",{class:"choiceBox",onclick:()=>r.onChoiceSelected(t)},t.text))),l?"":(0,e.default)("span",{class:"arrow"})])]))}};var O={isBusy:()=>l,mount:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.default.mount(document.getElementById("ui"),{view:()=>(0,e.default)(b,t)})},unmount:()=>e.default.mount(document.getElementById("ui"),null),callText:e=>{c&&p(o({},e))}};exports.default=O;
},{"mithril":"Vx2X","./effects":"LhRf"}],"T5YV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.MODES=void 0;var e=require("./events");function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?t(Object(o),!0).forEach(function(t){n(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o={NOTRUNNING:100,NEXTNODE:200,AWAITINGINPUT:300,JUSTFINISHED:400,COMPLETED:500};exports.MODES=o;var c=t=>{let{conversationData:n,onChatStarted:c=((e,t)=>{}),onChatNext:i=((e,t)=>{}),onChatComplete:s=(e=>{}),onChainProgress:a=(e=>{}),onChatCancelled:l=(()=>{})}=t,u=0,d=n[u],O=!1,E=!1;const f=e=>{if(e)return d=e,u=e.index,e;throw"No node match."},N=e=>{const t=n.length?n.filter(t=>e===t.id)[0]:null;return f(t)},p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=N(e);return i(n,t),r(r({},f(n)),{},{mode:o.NEXTNODE})};return{isComplete:()=>E,isRunning:()=>O,currentIndex:()=>u,start:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=N(e);return O=!0,E=!1,c(n,t),r(r({},f(n)),{},{mode:o.NEXTNODE})},goToExact:p,goToNext:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!O)return{mode:o.NOTRUNNING};if(E)return O=!1,{mode:o.COMPLETED};const{id:n,to:c,choices:i,actions:u,dataActions:f}=d;return i.length?r(r({},d),{},{mode:o.AWAITINGINPUT}):u.some(e=>"endConversation"===e)||0===i.length&&!c?(u.some(e=>"save"===e)&&a(n),u.some(e=>"cancel"===e)&&l(),f&&f.length&&f.forEach(t=>{switch(t.id){case"giveQuest":(0,e.emit)(e.EV_GIVEQUEST,t);break;case"updateConvoTrigger":(0,e.emit)(e.EV_UPDATECONVOTRIGGER,t)}}),E=!0,s(n),console.log("End reached, close the convo."),r(r({},d),{},{mode:o.JUSTFINISHED})):r(r({},p(c,t)),{},{mode:o.NEXTNODE})}}};exports.default=c;
},{"./events":"imji"}],"iTZV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("kontra"),r=function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},s=!1;return o=>{!s&&(0,e.keyPressed)(r)?(t(o),s=!0):s&&!(0,e.keyPressed)("e")&&(s=!1)}};exports.default=r;
},{"kontra":"crkq"}],"Ylfw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("kontra"),t=s(require("../ui/dialogue")),r=require("../common/events"),o=a(require("../common/conversationIterator")),n=s(require("../input/onPush"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function a(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=o?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}function s(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(null==e)return{};var r,o,n=l(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)r=u[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function l(e,t){if(null==e)return{};var r,o,n={},u=Object.keys(e);for(o=0;o<u.length;o++)r=u[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}var c=u=>{let{id:a,startId:s,onEntry:l=(()=>{}),onExit:c=(()=>{})}=u;console.log("Start convo.");let f=!1;const d=e.dataAssets["assets/gameData/conversationData.json"],p=(0,o.default)({conversationData:d,onChatComplete:e=>{t.default.unmount(),(0,r.emit)(r.EV_CONVOEND,{exitId:e})},onChainProgress:t=>(0,e.setStoreItem)("progress",{storyProgress:t})}),O=e=>{let{actor:r,text:o,choices:n}=e;return t.default.callText({name:r,text:o,choices:n})},E=(0,n.default)("e",()=>{if(t.default.isBusy())return;const e=p.isRunning()?p.goToNext():p.start(s,{startId:s}),{mode:r}=e,n=i(e,["mode"]);r===o.MODES.NEXTNODE&&O(n),f=r===o.MODES.JUSTFINISHED||r===o.MODES.COMPLETED});return t.default.mount({onChoiceSelected:e=>{console.log("Selected:"),console.log(e);const t=p.goToExact(e.to),{mode:r}=t,n=i(t,["mode"]);r===o.MODES.NEXTNODE&&O(n),f=r===o.MODES.JUSTFINISHED||r===o.MODES.COMPLETED}}),{id:"conversation",isComplete:()=>f,enter:e=>l(),update:()=>E(),exit:()=>c()}};exports.default=c;
},{"kontra":"crkq","../ui/dialogue":"f6vQ","../common/events":"imji","../common/conversationIterator":"T5YV","../input/onPush":"iTZV"}],"elJh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("kontra"),t=o(require("mithril")),l=require("../common/consts");function o(e){return e&&e.__esModule?e:{default:e}}let n=!1;const u=o=>{let{attrs:u}=o;const i=(0,e.getStoreItem)("entities").filter(e=>e.type===l.ENTITY_TYPE.PICKUP),d=e.dataAssets["assets/gameData/entityData.json"];return{oninit:()=>n=!0,onremove:()=>n=!1,view:()=>(0,t.default)("div",{class:"uiShell"},[(0,t.default)("div",{class:"dialogueBoxOuter"},[(0,t.default)("div",{class:"dialogue"},[i.length?(0,t.default)("dl",{class:"itemListing"},i.map(e=>{const l=d.find(t=>{let{id:l}=t;return l===e.id}),o=e?e.qty:0;return(0,t.default)("dd",{class:"itemNode",onclick:()=>u.onItemSelected(l)},[(0,t.default)("img",{src:l.thumb}),(0,t.default)("h4","".concat(l.name,": x").concat(o)),(0,t.default)("h5",l.description)])})):(0,t.default)("p","No items."),(0,t.default)("div",{class:"choiceWindow"},(0,t.default)("button",{class:"choiceBox",onclick:()=>u.onInventoryClosed()},"Close"))])])])}};var i={isBusy:()=>n,mount:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.default.mount(document.getElementById("ui"),{view:()=>(0,t.default)(u,e)})},unmount:()=>t.default.mount(document.getElementById("ui"),null)};exports.default=i;
},{"kontra":"crkq","mithril":"Vx2X","../common/consts":"ni7Z"}],"yKYj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("kontra"),t=u(require("mithril"));function u(e){return e&&e.__esModule?e:{default:e}}let s=!1;const l=u=>{let{attrs:l}=u;const d=(0,e.getStoreItem)("quests"),o=e.dataAssets["assets/gameData/questData.json"];return{oninit:()=>s=!0,onremove:()=>s=!1,view:()=>(0,t.default)("div",{class:"uiShell"},[(0,t.default)("div",{class:"dialogueBoxOuter"},[(0,t.default)("div",{class:"dialogue"},[d.length?(0,t.default)("dl",{class:"questListing"},d.map(e=>{let{props:u}=e;const s=o.find(e=>{let{id:t}=e;return t===u.questId}),d=s.parts.find(e=>e.index===u.questPart);return(0,t.default)("dd",{class:"questNode",onclick:()=>l.onQuestSelected(s)},[(0,t.default)("h4",s.name),(0,t.default)("h5",d.description)])})):(0,t.default)("p","No quests."),(0,t.default)("div",{class:"choiceWindow"},(0,t.default)("button",{class:"choiceBox",onclick:()=>l.onQuestlogClosed()},"Close"))])])])}};var d={isBusy:()=>s,mount:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.default.mount(document.getElementById("ui"),{view:()=>(0,t.default)(l,e)})},unmount:()=>t.default.mount(document.getElementById("ui"),null)};exports.default=d;
},{"kontra":"crkq","mithril":"Vx2X"}],"TXqO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("../ui/inventory")),t=n(require("../ui/questlog")),o=n(require("../input/onPush"));function n(e){return e&&e.__esModule?e:{default:e}}var u=n=>{let{id:u,reactionManager:l,onEntry:i=(()=>{}),onExit:r=(()=>{})}=n,s=!1;const d=(0,o.default)("e",e=>{let{origin:t,collisions:o=[]}=e;if(o.length&&t.controlledByUser)if(s)s=!1;else{const e=o[0],n=l.get(e.type);n&&n.reactionEvent(e,[e,t])}}),a=(0,o.default)("space",e=>{let{origin:t,collisions:o=[]}=e;o.map(e=>{"function"==typeof e.onAttacked&&e.onAttacked({origin:t})})}),f=(0,o.default)("i",()=>{e.default.isBusy()||e.default.mount({onInventoryClosed:()=>e.default.unmount(),onItemSelected:e=>{console.log(e)}})}),c=(0,o.default)("q",()=>{t.default.isBusy()||t.default.mount({onQuestlogClosed:()=>t.default.unmount(),onQuestSelected:e=>{console.log(e)}})});return{id:u,isComplete:()=>!1,enter:e=>i(),update:e=>{d(e),a(e),f(),c()},exit:()=>r()}};exports.default=u;
},{"../ui/inventory":"elJh","../ui/questlog":"yKYj","../input/onPush":"iTZV"}],"THiO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=e=>{let{id:t,ctx:o,direction:r=1,onFadeComplete:d=(()=>{})}=e,i=!1,a=r<0?1:0;const l=document.getElementById("curtain");return l.style.opacity=r<0?1:0,{id:t,isComplete:()=>i,enter:e=>{},update:()=>{i=r>0&&a>=1||r<0&&a<=-1,a=r<0?a-.05:a+.05,l.style.opacity=i?Math.round(a):a},exit:()=>{l.style.opacity=r<0?0:1,0===r&&l.remove(),d()}}};exports.default=e;
},{}],"XeGn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=e=>{let{sceneObject:t}=e,r=null;return{loadScene:e=>{r&&r.stop(),(r=t(e)).start()}}};exports.default=e;
},{}],"aLWx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=()=>{let e=[];const t=e=>e[e.length-1];return{push:(i,p)=>{e.some(e=>e.id===i.id)||(e.push(i),t(e).enter(p))},update:i=>{const p=t(e);p&&(p.update(i),p.isComplete()&&(p.exit(),e=e.filter(e=>e.id!==p.id)))},pop:()=>{t(e).exit(),e.pop()},popState:t=>{const i=e.find(e=>e.id===t);i&&(i.exit(),e=e.filter(e=>e.id!==t))},clearStates:()=>e.length=0}};exports.default=e;
},{}],"oFjS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.flipSprite=exports.moveSprite=void 0;var e=require("../common/helpers");const t=t=>{let{dir:i,sprite:o,checkCollision:r=(()=>!1)}=t;const s=(0,e.getNormal)(i);let l={x:o.x,y:o.y};o.x+=s.x;const c=r(o);o.collidesWithTiles&&c&&(o.x=l.x,o.y=l.y),l={x:o.x,y:o.y},o.y+=s.y;const x=r(o);return o.collidesWithTiles&&x&&(o.x=l.x,o.y=l.y),{directionNormal:s}};exports.moveSprite=t;const i=e=>{let{direction:t,sprite:i}=e;t.x<0&&i.scaleX>0?i.setScale(-1,1):t.x>0&&i.scaleX<0&&i.setScale(1,1)};exports.flipSprite=i;
},{"../common/helpers":"bQKU"}],"jfsY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("../managers/stateManager")),i=require("../common/spriteFunctions"),t=require("../common/helpers"),o=require("kontra");function n(e){return e&&e.__esModule?e:{default:e}}var s=n=>{let{id:s,x:r,y:a,z:l=1,customProperties:d={},entityData:u=null,collisionMethod:c=((e,i)=>{})}=n;if(!s)throw new Error("Entity is fairly useless without an id, you should add one.");const m=(0,e.default)(),{name:y,type:p,animations:h,frameWidth:f,frameHeight:x,sheet:k,collisionBodyOptions:P=null,manualAnimation:v=!1,controlledByUser:g=!1,collidesWithTiles:A=!0,collidesWithPlayer:M=!1}=u;let S=(0,o.SpriteSheet)({image:o.imageAssets[k],frameWidth:f,frameHeight:x,animations:h}),W={x:0,y:0},q=!1;const w=(0,o.Sprite)({instId:(0,t.uniqueId)(s),id:s,type:p,name:y,x:r,y:a,z:l,anchor:{x:.5,y:.5},customProperties:d,radius:2,animations:S.animations,collidesWithTiles:A,controlledByUser:g,collisionBodyOptions:P,collidesWithPlayer:M,manualAnimation:v,onAttacked:()=>{console.log(s)},enableMovement:()=>q=!1,disableMovement:()=>q=!0,lookAt:e=>{let{x:t,y:o}=e;(0,i.flipSprite)({direction:{x:w.x>t?-1:1,y:w.y>o?-1:1},sprite:w})},update:()=>{m.update(),W=g?{x:(0,o.keyPressed)("a")?-1:(0,o.keyPressed)("d")?1:0,y:(0,o.keyPressed)("w")?-1:(0,o.keyPressed)("s")?1:0}:{x:0,y:0};const{directionNormal:e}=(0,i.moveSprite)({dir:q?{x:0,y:0}:W,sprite:w,checkCollision:e=>c("collision",e)});(0,i.flipSprite)({direction:e,sprite:w});const t=0!==e.x||0!==e.y;w.manualAnimation||w.playAnimation(t?"walk":"idle"),w.advance()}});return w};exports.default=s;
},{"../managers/stateManager":"aLWx","../common/spriteFunctions":"oFjS","../common/helpers":"bQKU","kontra":"crkq"}],"RwqI":[function(require,module,exports) {
module.exports=function(){this.pointsToAvoid={},this.startX,this.callback,this.startY,this.endX,this.endY,this.nodeHash={},this.openList};
},{}],"vH9K":[function(require,module,exports) {
module.exports=function(t,s,i,e,o){this.parent=t,this.x=s,this.y=i,this.costSoFar=e,this.simpleDistanceToTarget=o,this.bestGuessDistance=function(){return this.costSoFar+this.simpleDistanceToTarget}};
},{}],"DPxs":[function(require,module,exports) {
var define;
var t;(function(){var n,e,o,r,p,u,i,s,l,c,h,f,a,y,d,g,v;o=Math.floor,c=Math.min,e=function(t,n){return t<n?-1:t>n?1:0},l=function(t,n,r,p,u){var i;if(null==r&&(r=0),null==u&&(u=e),r<0)throw new Error("lo must be non-negative");for(null==p&&(p=t.length);r<p;)u(n,t[i=o((r+p)/2)])<0?p=i:r=i+1;return[].splice.apply(t,[r,r-r].concat(n)),n},u=function(t,n,o){return null==o&&(o=e),t.push(n),y(t,0,t.length-1,o)},p=function(t,n){var o,r;return null==n&&(n=e),o=t.pop(),t.length?(r=t[0],t[0]=o,d(t,0,n)):r=o,r},s=function(t,n,o){var r;return null==o&&(o=e),r=t[0],t[0]=n,d(t,0,o),r},i=function(t,n,o){var r;return null==o&&(o=e),t.length&&o(t[0],n)<0&&(n=(r=[t[0],n])[0],t[0]=r[1],d(t,0,o)),n},r=function(t,n){var r,p,u,i,s,l;for(null==n&&(n=e),s=[],p=0,u=(i=function(){l=[];for(var n=0,e=o(t.length/2);0<=e?n<e:n>e;0<=e?n++:n--)l.push(n);return l}.apply(this).reverse()).length;p<u;p++)r=i[p],s.push(d(t,r,n));return s},a=function(t,n,o){var r;if(null==o&&(o=e),-1!==(r=t.indexOf(n)))return y(t,0,r,o),d(t,r,o)},h=function(t,n,o){var p,u,s,l,c;if(null==o&&(o=e),!(u=t.slice(0,n)).length)return u;for(r(u,o),s=0,l=(c=t.slice(n)).length;s<l;s++)p=c[s],i(u,p,o);return u.sort(o).reverse()},f=function(t,n,o){var u,i,s,h,f,a,y,d,g;if(null==o&&(o=e),10*n<=t.length){if(!(s=t.slice(0,n).sort(o)).length)return s;for(i=s[s.length-1],h=0,a=(y=t.slice(n)).length;h<a;h++)o(u=y[h],i)<0&&(l(s,u,0,null,o),s.pop(),i=s[s.length-1]);return s}for(r(t,o),g=[],f=0,d=c(n,t.length);0<=d?f<d:f>d;0<=d?++f:--f)g.push(p(t,o));return g},y=function(t,n,o,r){var p,u,i;for(null==r&&(r=e),p=t[o];o>n&&r(p,u=t[i=o-1>>1])<0;)t[o]=u,o=i;return t[o]=p},d=function(t,n,o){var r,p,u,i,s;for(null==o&&(o=e),p=t.length,s=n,u=t[n],r=2*n+1;r<p;)(i=r+1)<p&&!(o(t[r],t[i])<0)&&(r=i),t[n]=t[r],r=2*(n=r)+1;return t[n]=u,y(t,s,n,o)},n=function(){function t(t){this.cmp=null!=t?t:e,this.nodes=[]}return t.push=u,t.pop=p,t.replace=s,t.pushpop=i,t.heapify=r,t.updateItem=a,t.nlargest=h,t.nsmallest=f,t.prototype.push=function(t){return u(this.nodes,t,this.cmp)},t.prototype.pop=function(){return p(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return s(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return i(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return r(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return a(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var n;return(n=new t).nodes=this.nodes.slice(0),n},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),g=this,v=function(){return n},"function"==typeof t&&t.amd?t([],v):"object"==typeof exports?module.exports=v():g.Heap=v()}).call(this);
},{}],"tAIw":[function(require,module,exports) {
module.exports=require("./lib/heap");
},{"./lib/heap":"DPxs"}],"uR5w":[function(require,module,exports) {
var t={},n=require("./instance"),i=require("./node"),e=require("heap");const o=0,r=1;module.exports=t;var s=1;t.js=function(){var o,r,a,l=!1,u={},f={},h={},c={},d=!0,T={},v=[],y=Number.MAX_VALUE,x=!1;this.setAcceptableTiles=function(t){t instanceof Array?a=t:!isNaN(parseFloat(t))&&isFinite(t)&&(a=[t])},this.enableSync=function(){l=!0},this.disableSync=function(){l=!1},this.enableDiagonals=function(){x=!0},this.disableDiagonals=function(){x=!1},this.setGrid=function(t){o=t;for(var n=0;n<o.length;n++)for(var i=0;i<o[0].length;i++)f[o[n][i]]||(f[o[n][i]]=1)},this.setTileCost=function(t,n){f[t]=n},this.setAdditionalPointCost=function(t,n,i){void 0===h[n]&&(h[n]={}),h[n][t]=i},this.removeAdditionalPointCost=function(t,n){void 0!==h[n]&&delete h[n][t]},this.removeAllAdditionalPointCosts=function(){h={}},this.setDirectionalCondition=function(t,n,i){void 0===c[n]&&(c[n]={}),c[n][t]=i},this.removeAllDirectionalConditions=function(){c={}},this.setIterationsPerCalculation=function(t){y=t},this.avoidAdditionalPoint=function(t,n){void 0===u[n]&&(u[n]={}),u[n][t]=1},this.stopAvoidingAdditionalPoint=function(t,n){void 0!==u[n]&&delete u[n][t]},this.enableCornerCutting=function(){d=!0},this.disableCornerCutting=function(){d=!1},this.stopAvoidingAllAdditionalPoints=function(){u={}},this.findPath=function(t,i,r,u,f){var h=function(t){l?f(t):setTimeout(function(){f(t)})};if(void 0===a)throw new Error("You can't set a path without first calling setAcceptableTiles() on EasyStar.");if(void 0===o)throw new Error("You can't set a path without first calling setGrid() on EasyStar.");if(t<0||i<0||r<0||u<0||t>o[0].length-1||i>o.length-1||r>o[0].length-1||u>o.length-1)throw new Error("Your start or end point is outside the scope of your grid.");if(t!==r||i!==u){for(var c=o[u][r],d=!1,y=0;y<a.length;y++)if(c===a[y]){d=!0;break}if(!1!==d){var x=new n;x.openList=new e(function(t,n){return t.bestGuessDistance()-n.bestGuessDistance()}),x.isDoneCalculating=!1,x.nodeHash={},x.startX=t,x.startY=i,x.endX=r,x.endY=u,x.callback=h,x.openList.push(P(x,x.startX,x.startY,null,1));var p=s++;return T[p]=x,v.push(p),p}h(null)}else h([])},this.cancelPath=function(t){return t in T&&(delete T[t],!0)},this.calculate=function(){if(0!==v.length&&void 0!==o&&void 0!==a)for(r=0;r<y;r++){if(0===v.length)return;l&&(r=0);var t=v[0],n=T[t];if(void 0!==n)if(0!==n.openList.size()){var i=n.openList.pop();if(n.endX!==i.x||n.endY!==i.y)i.list=0,i.y>0&&p(n,i,0,-1,1*b(i.x,i.y-1)),i.x<o[0].length-1&&p(n,i,1,0,1*b(i.x+1,i.y)),i.y<o.length-1&&p(n,i,0,1,1*b(i.x,i.y+1)),i.x>0&&p(n,i,-1,0,1*b(i.x-1,i.y)),x&&(i.x>0&&i.y>0&&(d||g(o,a,i.x,i.y-1,i)&&g(o,a,i.x-1,i.y,i))&&p(n,i,-1,-1,1.4*b(i.x-1,i.y-1)),i.x<o[0].length-1&&i.y<o.length-1&&(d||g(o,a,i.x,i.y+1,i)&&g(o,a,i.x+1,i.y,i))&&p(n,i,1,1,1.4*b(i.x+1,i.y+1)),i.x<o[0].length-1&&i.y>0&&(d||g(o,a,i.x,i.y-1,i)&&g(o,a,i.x+1,i.y,i))&&p(n,i,1,-1,1.4*b(i.x+1,i.y-1)),i.x>0&&i.y<o.length-1&&(d||g(o,a,i.x,i.y+1,i)&&g(o,a,i.x-1,i.y,i))&&p(n,i,-1,1,1.4*b(i.x-1,i.y+1)));else{var e=[];e.push({x:i.x,y:i.y});for(var s=i.parent;null!=s;)e.push({x:s.x,y:s.y}),s=s.parent;e.reverse();var u=e;n.callback(u),delete T[t],v.shift()}}else n.callback(null),delete T[t],v.shift();else v.shift()}};var p=function(t,n,i,e,r){var s=n.x+i,l=n.y+e;if((void 0===u[l]||void 0===u[l][s])&&g(o,a,s,l,n)){var f=P(t,s,l,n,r);void 0===f.list?(f.list=1,t.openList.push(f)):n.costSoFar+r<f.costSoFar&&(f.costSoFar=n.costSoFar+r,f.parent=n,t.openList.updateItem(f))}},g=function(t,n,i,e,o){var r=c[e]&&c[e][i];if(r){var s=O(o.x-i,o.y-e);if(!function(){for(var t=0;t<r.length;t++)if(r[t]===s)return!0;return!1}())return!1}for(var a=0;a<n.length;a++)if(t[e][i]===n[a])return!0;return!1},O=function(n,i){if(0===n&&-1===i)return t.TOP;if(1===n&&-1===i)return t.TOP_RIGHT;if(1===n&&0===i)return t.RIGHT;if(1===n&&1===i)return t.BOTTOM_RIGHT;if(0===n&&1===i)return t.BOTTOM;if(-1===n&&1===i)return t.BOTTOM_LEFT;if(-1===n&&0===i)return t.LEFT;if(-1===n&&-1===i)return t.TOP_LEFT;throw new Error("These differences are not valid: "+n+", "+i)},b=function(t,n){return h[n]&&h[n][t]||f[o[n][t]]},P=function(t,n,e,o,r){if(void 0!==t.nodeHash[e]){if(void 0!==t.nodeHash[e][n])return t.nodeHash[e][n]}else t.nodeHash[e]={};var s=A(n,e,t.endX,t.endY);if(null!==o)var a=o.costSoFar+r;else a=0;var l=new i(o,n,e,a,s);return t.nodeHash[e][n]=l,l},A=function(t,n,i,e){var o,r;return x?(o=Math.abs(t-i))<(r=Math.abs(n-e))?1.4*o+r:1.4*r+o:(o=Math.abs(t-i))+(r=Math.abs(n-e))}},t.TOP="TOP",t.TOP_RIGHT="TOP_RIGHT",t.RIGHT="RIGHT",t.BOTTOM_RIGHT="BOTTOM_RIGHT",t.BOTTOM="BOTTOM",t.BOTTOM_LEFT="BOTTOM_LEFT",t.LEFT="LEFT",t.TOP_LEFT="TOP_LEFT";
},{"./instance":"RwqI","./node":"vH9K","heap":"tAIw"}],"gzgG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.wait=exports.findPath=void 0;var e=t(require("easystarjs"));function t(e){return e&&e.__esModule?e:{default:e}}const n=t=>{let{aiPathGrid:n,tx:r,ty:s,rx:a,ry:i,walkableId:l}=t;return new Promise(t=>{const o=new e.default.js;o.enableDiagonals(),o.enableCornerCutting(),o.setGrid(n),o.setAcceptableTiles([l]),o.findPath(r,s,a,i,function(e){null===e||null!==e&&0===e.length?t([]):t(e)}),o.calculate()})};exports.findPath=n;const r=e=>new Promise(t=>setTimeout(t,e));exports.wait=r;
},{"easystarjs":"uR5w"}],"mvKI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("kontra"),t=require("../common/helpers"),r=require("../common/spriteFunctions"),o=require("../common/aiHelpers"),n=n=>{let{props:l,onEntry:i=(()=>{}),onExit:a=(()=>{})}=n;const u=(0,t.Queue)(),{aiPathGrid:s,sprite:c}=l,d=Math.floor(c.x/16),p=Math.floor(c.y/16);let h=[];for(let t=0;t<s.length;t++)for(let r=0;r<s[t].length;r++)102===s[t][r]&&h.push((0,e.Vector)(r,t));if(!h.length)throw"No walkable tiles were found.";const x=h[(0,t.getRandomIntInclusive)(0,h.length-1)];let f=x.x,y=x.y,m=!1,g=(0,e.Vector)(c.x,c.y),v=null,q=null;return{id:"followPath",isComplete:()=>m,enter:async r=>{const n=await(0,o.findPath)({aiPathGrid:s,tx:d,ty:p,rx:f,ry:y,walkableId:102});if(n.length){for(let r=1;r<n.length;r++)u.enqueue((0,e.Vector)(16*n[r].x+(0,t.getRandomIntInclusive)(0,16),16*n[r].y+(0,t.getRandomIntInclusive)(0,16)));v=u.dequeue(),q=(0,e.Vector)(v.x,v.y),i()}else m=!0},update:()=>{if(!q)return void(m=!0);let t=(0,e.Vector)(0,0);q.subtract(g).length()>1?(t=q.subtract(g).normalize().scale(.75),c.x+=t.x,c.y+=t.y,g=(0,e.Vector)(c.x,c.y)):q=u.dequeue(),(0,r.flipSprite)({direction:t,sprite:c});const o=0!==t.x||0!==t.y;c.manualAnimation||c.playAnimation(o?"walk":"idle"),c.advance()},exit:()=>a()}};exports.default=n;
},{"kontra":"crkq","../common/helpers":"bQKU","../common/spriteFunctions":"oFjS","../common/aiHelpers":"gzgG"}],"nPYw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=e=>{let{props:t,onEntry:r=(()=>{}),onUpdate:i=(()=>{}),onExit:o=(()=>{})}=e;return{id:"idle",isComplete:()=>!1,enter:e=>r(),update:()=>{t.sprite.playAnimation("idle"),t.sprite.advance(),i()},exit:()=>o()}};exports.default=e;
},{}],"Ko0P":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("../managers/stateManager")),t=s(require("../states/aiFollowPathState")),r=s(require("../states/aiIdleState")),o=require("../common/spriteFunctions"),i=require("../common/helpers"),a=require("../common/aiHelpers"),n=require("kontra");function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){d(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const p=()=>{const o=(0,e.default)();let n={};const s={talkMode:()=>{o.push((0,r.default)({props:{sprite:n.sprite}}))},idleAndRoam:()=>{o.push((0,r.default)({props:{sprite:n.sprite},onEntry:async()=>{await(0,a.wait)((0,i.getRandomIntInclusive)(500,1500)),o.popState("idle")},onExit:()=>s.followPath()}))},followPath:()=>{o.push((0,t.default)({props:n,onExit:()=>{s.idleAndRoam()}}))}};return{bootstrap:e=>n=u({},e),update:()=>o.update(),start:()=>s.idleAndRoam(),talkMode:()=>{o.clearStates(),s.talkMode()},reset:()=>{o.clearStates(),s.idleAndRoam()}}};var c=e=>{let{id:t,x:r,y:a,z:s=1,customProperties:l={},entityData:u=null,aiPathGrid:d=null,collisionMethod:c=((e,t)=>{})}=e;if(!t)throw new Error("Entity is fairly useless without an id, you should add one.");const{name:m,type:f,animations:y,frameWidth:h,frameHeight:b,sheet:O,collisionBodyOptions:P=null,manualAnimation:g=!1,controlledByUser:w=!1,collidesWithTiles:j=!0,collidesWithPlayer:v=!0}=u;let x=(0,n.SpriteSheet)({image:n.imageAssets[O],frameWidth:h,frameHeight:b,animations:y});const S=p(),M=(0,n.Sprite)({instId:(0,i.uniqueId)(t),id:t,type:f,name:m,x:r,y:a,z:s,anchor:{x:.5,y:.5},customProperties:l,radius:1,animations:x.animations,collidesWithTiles:j,controlledByUser:w,collisionBodyOptions:P,collidesWithPlayer:v,manualAnimation:g,enableMovement:()=>S.reset(),disableMovement:()=>S.talkMode(),lookAt:e=>{let{x:t,y:r}=e;(0,o.flipSprite)({direction:{x:M.x>t?-1:1,y:M.y>r?-1:1},sprite:M})},update:()=>S.update()});return S.bootstrap({sprite:M,aiPathGrid:d}),S.start(),M};exports.default=c;
},{"../managers/stateManager":"aLWx","../states/aiFollowPathState":"mvKI","../states/aiIdleState":"nPYw","../common/spriteFunctions":"oFjS","../common/helpers":"bQKU","../common/aiHelpers":"gzgG","kontra":"crkq"}],"BjzK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("../common/helpers"),i=require("kontra"),t=t=>{let{id:o,x:n,y:s,z:a=1,customProperties:l={},entityData:r=null,collisionMethod:d=((e,i)=>{})}=t;if(!o)throw new Error("Entity is fairly useless without an id, you should add one.");const{name:u,type:c,animations:m,frameWidth:h,frameHeight:y,sheet:p,collisionBodyOptions:f=null,manualAnimation:x=!1,controlledByUser:W=!1,collidesWithTiles:g=!0,collidesWithPlayer:P=!0}=r;let v=(0,i.SpriteSheet)({image:i.imageAssets[p],frameWidth:h,frameHeight:y,animations:m});const A=(0,i.Sprite)({instId:(0,e.uniqueId)(o),id:o,type:c,name:u,x:n,y:s,z:a,anchor:{x:.5,y:.5},customProperties:l,radius:1,animations:v.animations,collidesWithTiles:g,controlledByUser:W,collisionBodyOptions:f,collidesWithPlayer:P,manualAnimation:x,onAttacked:()=>{console.log(o)},update:()=>{A.advance()}});return A};exports.default=t;
},{"../common/helpers":"bQKU","kontra":"crkq"}],"jQVp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("kontra"),t=s(require("../sprites/player")),r=s(require("../sprites/npc")),i=s(require("../sprites/fixed")),a=s(require("../sprites/pickup")),o=require("../common/consts"),n=require("../common/events"),l=s(require("../services/store"));function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach(function(t){d(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var p=()=>((0,n.on)(n.EV_GIVEQUEST,e=>l.default.updateQuestData(e)),(0,n.on)(n.EV_UPDATECONVOTRIGGER,e=>l.default.updateProgress(e)),{createWorld:n=>{let{areaId:s,playerStartId:u}=n;const{entities:d,mapKey:p}=l.default.getWorldData().find(e=>e.areaId===s),f=l.default.getMapData(p),y=(0,e.TileEngine)(f),h=y.layers.find(e=>2===e.id);let P=[];for(let e=0;e<h.width;e++){P.push([]);for(let t=0;t<h.height;t++){const r=y.tileAtLayer("AIPath",{row:e,col:t});P[e].push(r)}}const O=d.find(e=>e.customProperties.playerStartId===u),b=l.default.getEntityData().find(e=>"player"===e.id),E=(0,t.default)({id:"player",x:O.x,y:O.y,entityData:b,collisionMethod:(e,t)=>{const r=0,i=4,a={width:10,height:8,x:t.x+r,y:t.y+i,anchor:t.anchor};return y.layerCollidesWith(e,a)}});return y.addObject(E),{mapKey:p,tileEngine:y,aiPathGrid:P,player:E,sprites:d.map(e=>{const{id:t}=e;let n=null;const s=l.default.getEntityData().find(e=>e.id===t);switch(e.customProperties&&l.default.pushProgress(c({id:e.id},e.customProperties)),s.type){case o.ENTITY_TYPE.PICKUP:if(l.default.getEntityFromStore(t))return null;n=(0,a.default)(c(c({},e),{},{entityData:s,collisionMethod:(e,t)=>y.layerCollidesWith(e,t)}));break;case o.ENTITY_TYPE.NPC:n=(0,r.default)(c(c({},e),{},{entityData:s,aiPathGrid:P,collisionMethod:(e,t)=>y.layerCollidesWith(e,t)}));break;case o.ENTITY_TYPE.DOOR:case o.ENTITY_TYPE.FIXED:n=(0,i.default)(c(c({},e),{},{entityData:s,collisionMethod:(e,t)=>y.layerCollidesWith(e,t)}));break;default:return null}return y.addObject(n),n}).filter(e=>e).concat([E])}}});exports.default=p;
},{"kontra":"crkq","../sprites/player":"jfsY","../sprites/npc":"Ko0P","../sprites/fixed":"BjzK","../sprites/pickup":"BjzK","../common/consts":"ni7Z","../common/events":"imji","../services/store":"NCDA"}],"cJ3v":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{get:t=>e.find(e=>e.type===t)}};exports.default=e;
},{}],"H99C":[function(require,module,exports) {
"use strict";var e=require("kontra"),t=require("./common/helpers"),a=require("./common/consts"),r=require("./common/events"),n=u(require("./services/store")),i=u(require("./states/startConvoState")),o=u(require("./states/fieldState")),s=u(require("./states/curtainState")),l=u(require("./managers/sceneManager")),d=u(require("./managers/worldManager")),c=u(require("./managers/reactionManager")),g=u(require("./managers/stateManager"));function u(e){return e&&e.__esModule?e:{default:e}}function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach(function(t){p(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function p(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const y={width:256,height:192,scale:3},{canvas:f}=(0,e.init)("gameCanvas"),E=document.getElementById("scaledCanvas"),b=document.getElementById("root");f.width=y.width,f.height=y.height,E.width=y.width*y.scale,E.height=y.height*y.scale,b.style.width=y.width*y.scale+"px",b.style.height=y.height*y.scale+"px";const v=f.getContext("2d");v.imageSmoothingEnabled=!1,v.webkitImageSmoothingEnabled=!1,v.mozImageSmoothingEnabled=!1,v.msImageSmoothingEnabled=!1,v.oImageSmoothingEnabled=!1;const S=E.getContext("2d");S.imageSmoothingEnabled=!1,S.webkitImageSmoothingEnabled=!1,S.mozImageSmoothingEnabled=!1,S.msImageSmoothingEnabled=!1,S.oImageSmoothingEnabled=!1;const w=l=>{const{createWorld:u}=(0,d.default)(),{sprites:m,player:h,tileEngine:p}=u(l);let b=m.filter(e=>e.isAlive());const v=(0,g.default)(),w=(0,g.default)(),O=(0,c.default)([{type:a.ENTITY_TYPE.DOOR,reactionEvent:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];w.push((0,s.default)({id:"curtain",ctx:S,direction:1,onFadeComplete:()=>{(0,r.allOff)([r.EV_SCENECHANGE]),(0,r.emit)(r.EV_SCENECHANGE,{areaId:e.customProperties.goesTo,playerStartId:e.customProperties.playerStartId})}}))}},{type:a.ENTITY_TYPE.NPC,reactionEvent:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const{customProperties:a}=e,r=n.default.getProgressDataStore().find(t=>t.id===e.id);Object.keys(a).length&&a.triggerConvo&&(h.disableMovement(),v.push((0,i.default)({startId:r.triggerConvo,onEntry:()=>t.filter(e=>"player"!==e.id).map(e=>{e.disableMovement(),e.lookAt({x:h.x,y:h.y})}),onExit:()=>t.map(e=>e.enableMovement())})))}},{type:a.ENTITY_TYPE.PICKUP,reactionEvent:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.ttl=0,n.default.updateEntityData(e)}}]);return v.push((0,o.default)({id:"field",sprites:m,tileEngine:p,reactionManager:O})),w.push((0,s.default)({id:"curtain",ctx:S,direction:-1})),(0,e.GameLoop)({update:()=>{b=b.filter(e=>e.isAlive());const e=(0,t.sortByDist)(h,(0,t.circleCollision)(h,b.filter(e=>"player"!==e.id&&e.collidesWithPlayer)));b.map(e=>e.update()),h.isColliding=e.length>0,v.update({origin:h,collisions:e}),p.sx=h.x-y.width/2,p.sy=h.y-y.height/2},render:()=>{p.renderLayer("rearDecor"),p.renderLayer("middleDecor"),b.sort((e,t)=>Math.round(e.y-e.z)-Math.round(t.y-t.z)).forEach(e=>e.render()),w.update(),p.renderLayer("forwardDecor"),S.drawImage(f,0,0,y.width,y.height,0,0,E.width,E.height)}})};(0,e.load)("assets/tileimages/test.png","assets/tiledata/test.json","assets/tiledata/test2.json","assets/tiledata/test3.json","assets/entityimages/little_devil.png","assets/entityimages/little_orc.png","assets/entityimages/little_bob.png","assets/gameData/conversationData.json","assets/gameData/entityData.json","assets/gameData/worldData.json","assets/gameData/questData.json").then(t=>{(0,e.initKeys)();const a=(0,l.default)({sceneObject:w});a.loadScene({areaId:"area1",playerStartId:"area1_entrance"}),(0,r.on)(r.EV_SCENECHANGE,e=>a.loadScene(h({},e)))});
},{"kontra":"crkq","./common/helpers":"bQKU","./common/consts":"ni7Z","./common/events":"imji","./services/store":"NCDA","./states/startConvoState":"Ylfw","./states/fieldState":"TXqO","./states/curtainState":"THiO","./managers/sceneManager":"XeGn","./managers/worldManager":"jQVp","./managers/reactionManager":"cJ3v","./managers/stateManager":"aLWx"}]},{},["H99C"], null)
//# sourceMappingURL=/src.6d1c9d0b.js.map